import{bP as re,bQ as ie,bR as L,bS as $,bT as y,bU as le,bV as ce,bW as ue,r as m,bX as de,bY as pe,j as P,f as me,bZ as fe,b_ as he,aV as ge,b$ as A,s as be,u as ve,V as D,ah as Ce,a4 as v,o as s,aD as xe,c0 as ke,p as c,z as N,N as R,B as C,T as p,c1 as Se,t as _e,A as z,a6 as ye,D as je,w as F,i as G,k as U,S as Be,a1 as Pe,c2 as De,aa as g,y as O}from"./index-3b67VH4-.js";import{M as q,D as H,c as h,C as W,a as Te,E as Ee,b as Ie,d as Q,T as V,S as Me}from"./StatDisplay-DN_thmMF.js";import{s as $e,c as Ae,P as Re}from"./PathIcon-DiyEyK0s.js";import{C as Oe,b as Ve,a as x}from"./UploadCard-vqCFQOAi.js";import{C as we}from"./CardActionArea-BVlWseCA.js";import{C as X,G as d}from"./Grid-BwNEbLl1.js";const Le=["component","direction","spacing","divider","children","className","useFlexGap"],Ne=re(),ze=ie("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root});function Fe(t){return fe({props:t,name:"MuiStack",defaultTheme:Ne})}function Ge(t,e){const a=m.Children.toArray(t).filter(Boolean);return a.reduce((n,o,r)=>(n.push(o),r<a.length-1&&n.push(m.cloneElement(e,{key:`separator-${r}`})),n),[])}const Ue=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],qe=({ownerState:t,theme:e})=>{let a=L({display:"flex",flexDirection:"column"},$({theme:e},y({values:t.direction,breakpoints:e.breakpoints.values}),n=>({flexDirection:n})));if(t.spacing){const n=le(e),o=Object.keys(e.breakpoints.values).reduce((l,u)=>((typeof t.spacing=="object"&&t.spacing[u]!=null||typeof t.direction=="object"&&t.direction[u]!=null)&&(l[u]=!0),l),{}),r=y({values:t.direction,base:o}),i=y({values:t.spacing,base:o});typeof r=="object"&&Object.keys(r).forEach((l,u,k)=>{if(!r[l]){const _=u>0?r[k[u-1]]:"column";r[l]=_}}),a=ce(a,$({theme:e},i,(l,u)=>t.useFlexGap?{gap:A(n,l)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${Ue(u?r[u]:t.direction)}`]:A(n,l)}}))}return a=ue(e.breakpoints,a),a};function He(t={}){const{createStyledComponent:e=ze,useThemeProps:a=Fe,componentName:n="MuiStack"}=t,o=()=>he({root:["root"]},l=>ge(n,l),{}),r=e(qe);return m.forwardRef(function(l,u){const k=a(l),S=de(k),{component:_="div",direction:K="column",spacing:ee=0,divider:I,children:M,className:te,useFlexGap:se=!1}=S,ne=pe(S,Le),oe={direction:K,spacing:ee,useFlexGap:se},ae=o();return P.jsx(r,L({as:_,ownerState:oe,ref:u,className:me(ae.root,te)},ne,{children:I?Ge(M,I):M}))})}const We=He({createStyledComponent:be("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root}),useThemeProps:t=>ve({props:t,name:"MuiStack"})}),Y=We;function Z(t){const{database:e}=D();return Ce(e.chars,t)}function J(t){return v.char[t]}function ft(t,e,a,n=0){switch(e){case"eidolon":return Object.fromEntries(v.char[t].rankMap[a].params.map((o,r)=>[r+1,o]));case"basic":case"skill":case"ult":case"talent":case"technique":return Object.fromEntries(v.char[t].skillTree[e].skillParamList[n].map((o,r)=>[r+1,o[a]]));case"bonusAbility1":case"bonusAbility2":case"bonusAbility3":return Object.fromEntries(v.char[t].skillTree[e].skillParamList[n][a].map((o,r)=>[r+1,o]))}}function Qe(t,e){const n=Xe(t,e).levels;if(!(n!=null&&n.length))throw new Error(`No stat boost levels found for character ${t}`);const o=Object.entries(n[0].stats??{});if(!o.length)throw new Error(`No stats found in stat boost for character ${t}`);const[r,i]=o[0];return{statKey:r,value:i}}function Xe(t,e){const{skillTree:a}=J(t);return a[`statBoost${e}`]}function b({characterKey:t,abilityKey:e,dropDownButtonProps:a={}}){const n=Z(t),{database:o}=D(),r=e.charAt(0).toUpperCase()+e.slice(1);return s(H,{title:`${r} Lv. ${(n==null?void 0:n[e])??1}`,disabled:!n,...a,children:!!t&&xe(1,ke[e][(n==null?void 0:n.ascension)??0]).map(i=>c(q,{selected:(n==null?void 0:n[e])===i,disabled:(n==null?void 0:n[e])===i,onClick:()=>o.chars.set(t,{[e]:i}),children:[r," Lv. ",i]},`${e}_${i}`))})}function Ye(){const t=m.useContext(Oe),e=m.useContext(Ve);return m.useMemo(()=>t==null?void 0:t.withTag(e),[t,e])}const Ze=["hp","atk","def","spd","crit_","crit_dmg_","brEffect_","heal_","enerRegen_","eff_","eff_res_"];function ht({character:t,onClick:e}){const a=Ye()??$e(Ae(t,1));return s(Y,{children:c(N,{children:[e?s(we,{onClick:e,children:s(w,{character:t})}):s(w,{character:t}),s(x,{}),s(X,{children:Ze.map(n=>s(Je,{calc:a,statKey:n,characterKey:t.key},n))})]})})}function w({character:t}){const{key:e,eidolon:a,level:n,ascension:o}=t,r=Q(e),{damageType:i,path:f,rarity:l}=J(e);return c(C,{sx:{display:"flex"},children:[s(C,{component:R?R:"img",alt:"Character Icon",src:h(r,"icon"),sx:{maxHeight:"10em",width:"auto"}}),c(C,{sx:{px:2,pt:1},children:[s(p,{variant:"h5",children:s(W,{genderedKey:r})}),s(p,{children:s(Te,{stars:l,inline:!0})}),c(p,{children:["Lv.",Se(n,o)," Eidolon: ",a]}),s(Re,{pathKey:f}),s(_e,{color:i,children:s(Ee,{ele:i})})]})]})}function Je({characterKey:t,calc:e,statKey:a}){return c(p,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"space-between"},children:[s(Ie,{statKey:a}),c("span",{children:[z(e.withTag({src:t,dst:t}).compute(ye.final[a]).val,a).toFixed(je(a)),F(a)]})]})}var T={},Ke=U;Object.defineProperty(T,"__esModule",{value:!0});var j=T.default=void 0,et=Ke(G()),tt=P,st=(0,et.default)((0,tt.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");j=T.default=st;var E={},nt=U;Object.defineProperty(E,"__esModule",{value:!0});var B=E.default=void 0,ot=nt(G()),at=P,rt=(0,ot.default)((0,at.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");B=E.default=rt;function gt({characterKey:t,onClose:e}){return s(Pe,{open:!!t,onClose:e,children:s(m.Suspense,{fallback:s(Be,{variant:"rectangular",width:"100%",height:1e3}),children:t&&s(it,{characterKey:t})})})}function it({characterKey:t}){const e=Z(t),a=Q(t),{database:n}=D();return s(N,{children:c(X,{sx:{display:"flex",flexDirection:"column",gap:1},children:[s(p,{variant:"h3",children:s(W,{genderedKey:a})}),s(V,{type:"number",label:"Level",variant:"outlined",inputProps:{min:1,max:90},value:(e==null?void 0:e.level)||0,onChange:o=>n.chars.set(t,{level:parseInt(o.target.value)}),disabled:!e}),s(V,{type:"number",label:"Ascension",variant:"outlined",inputProps:{min:0,max:6},value:(e==null?void 0:e.ascension)||0,onChange:o=>n.chars.set(t,{ascension:parseInt(o.target.value)}),disabled:!e}),s(H,{title:`Eidolon Lv. ${(e==null?void 0:e.eidolon)??0}`,fullWidth:!1,disabled:!e,children:De.map(o=>c(q,{selected:(e==null?void 0:e.eidolon)===o,disabled:(e==null?void 0:e.eidolon)===o,onClick:()=>n.chars.set(t,{eidolon:o}),children:["Eidolon Lv. ",o]},o))}),c(Y,{spacing:1,children:[s(p,{variant:"h6",children:"Abilites"}),s(x,{}),c(d,{container:!0,gap:1,children:[s(d,{item:!0,children:s(b,{characterKey:t,abilityKey:"basic",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(a,"basic_0")})}})}),s(d,{item:!0,children:s(b,{characterKey:t,abilityKey:"skill",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(a,"skill_0")})}})}),s(d,{item:!0,children:s(b,{characterKey:t,abilityKey:"ult",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(a,"ult_0")})}})}),s(d,{item:!0,children:s(b,{characterKey:t,abilityKey:"talent",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(a,"talent_0")})}})})]}),s(p,{variant:"h6",children:"Bonus Abilities"}),s(x,{}),s(d,{container:!0,gap:1,children:Object.entries((e==null?void 0:e.bonusAbilities)??{}).map(([o,r])=>s(d,{item:!0,children:s(O,{color:r?"success":"primary",onClick:()=>{n.chars.set(t,{bonusAbilities:{...e==null?void 0:e.bonusAbilities,[o]:!r}})},startIcon:r?s(j,{}):s(B,{}),children:s(g,{size:2,src:h(a,`bonusAbility${o}`),sideMargin:!0})})},o))}),s(p,{variant:"h6",children:"Stat Boosts"}),s(x,{}),s(d,{container:!0,gap:1,children:Object.entries((e==null?void 0:e.statBoosts)??{}).map(([o,r])=>{const{statKey:i,value:f}=Qe(t,o);return s(d,{item:!0,children:c(O,{color:r?"success":"primary",onClick:()=>{n.chars.set(t,{statBoosts:{...e==null?void 0:e.statBoosts,[o]:!r}})},startIcon:r?s(j,{}):s(B,{}),children:[s(Me,{statKey:i,iconProps:{sx:{ml:-1,mr:.5}}}),c(C,{children:[z(f,i),F(i)]})]})},o)})})]})]})})}export{gt as C,Y as S,ht as a,Ye as b,He as c,j as d,B as e,ft as f,J as g,Z as u};
