import{a as Ve,g as Ue,s as ve,ac as Rt,_ as K,ad as Xe,r as l,e as Je,ae as wt,af as It,j as O,f as Qe,b as Z,h as Ye,c as ye,ag as Et,u as _t,o as e,V as S,ah as re,i as Se,k as ke,ai as oe,aj as Pt,ak as Dt,al as zt,am as $t,an as Ze,p as h,B as C,ao as Lt,w as ge,T as k,ap as et,z as M,m as V,ab as tt,$ as nt,a0 as st,aq as Ot,aa as jt,ar as At,x as Nt,I as G,a1 as U,a3 as ce,Q as at,as as Ft,W as be,y as L,at as qt,au as Me,av as Ht,aw as Kt,ax as Wt,H as Gt,ay as Vt,az as ot,aA as Ut,aB as it,a2 as Xt,aC as Jt,a6 as Q,N as $e,aD as rt,aE as Qt,aF as Yt,aG as Zt,aH as en,aI as tn,aJ as nn,aK as Le,aL as sn,aM as an,S as ct,aN as on,aO as rn,aP as Oe}from"./index-SHvKIHba.js";import{r as cn,a as ln,O as lt,b as dn,C as un,t as hn,N as le,I as Te,E as de,L as pn,c as mn,R as fn,d as Cn,e as me,f as gn,g as bn,o as xn,W as vn,h as yn,S as Sn,i as kn,j as Mn,k as Tn,l as Bn,u as Rn,m as je,n as Ae,p as Ne,q as Fe,s as wn,v as In,w as En,x as _n,y as Pn,D as Dn,z as zn,A as $n,B as Ln,F as On,G as jn,H as An,J as Nn,K as Fn,M as qn}from"./Checkroom-BcaFVn_I.js";import{C as Hn,D as dt,a as w,b as Kn}from"./UploadCard-BvoW0y1M.js";import{T as ut,c as Wn,d as ht,M as ee,D as ue,b as Gn,C as Vn}from"./StatDisplay-DsrC3GaE.js";import{u as pt,b as te,S as F,g as Un,a as Xn,C as Jn}from"./CharacterEditor-CDhC0vrw.js";import{u as Qn,a as Yn,g as Zn}from"./LightConeTrans-CpYCvXmV.js";import{s as es,t as ts,w as qe,l as ns,a as ss,c as as}from"./index-Dp3Z0RuH.js";import{C as ne}from"./CardActionArea-LUpL1Zdh.js";import{d as X,D as os}from"./BusinessCenter-OAS49FCG.js";import{C as _,G as E}from"./Grid-CargbIeK.js";import{C as A}from"./CardHeader-B5uHyejC.js";import{u as J}from"./useBoolState-CYEISYxo.js";import{S as is,R as rs,b as mt}from"./RelicSetAutocomplete-CiwDj6En.js";import{L as cs}from"./LightConeEditorCard-YPZiC8YC.js";import{R as ls,a as ds,d as us}from"./RelicRarityDropdown-DVEc-JHD.js";import{D as hs}from"./Delete-BQ7zrLXV.js";import"./InfoTooltip-DTIN3Ovn.js";import"./LocationAutocomplete-CnNvJuTv.js";function ps(n){return Ve("PrivateSwitchBase",n)}Ue("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const ms=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],fs=n=>{const{classes:t,checked:s,disabled:a,edge:o}=n,i={root:["root",s&&"checked",a&&"disabled",o&&`edge${Z(o)}`],input:["input"]};return Ye(i,ps,t)},Cs=ve(Rt)(({ownerState:n})=>K({padding:9,borderRadius:"50%"},n.edge==="start"&&{marginLeft:n.size==="small"?-3:-12},n.edge==="end"&&{marginRight:n.size==="small"?-3:-12})),gs=ve("input",{shouldForwardProp:Xe})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),bs=l.forwardRef(function(t,s){const{autoFocus:a,checked:o,checkedIcon:i,className:r,defaultChecked:u,disabled:d,disableFocusRipple:c=!1,edge:p=!1,icon:m,id:y,inputProps:g,inputRef:b,name:P,onBlur:T,onChange:j,onFocus:D,readOnly:B,required:R=!1,tabIndex:N,type:z,value:f}=t,x=Je(t,ms),[v,q]=wt({controlled:o,default:!!u,name:"SwitchBase",state:"checked"}),$=It(),Pe=H=>{D&&D(H),$&&$.onFocus&&$.onFocus(H)},Mt=H=>{T&&T(H),$&&$.onBlur&&$.onBlur(H)},Tt=H=>{if(H.nativeEvent.defaultPrevented)return;const ze=H.target.checked;q(ze),j&&j(H,ze)};let Y=d;$&&typeof Y>"u"&&(Y=$.disabled);const Bt=z==="checkbox"||z==="radio",pe=K({},t,{checked:v,disabled:Y,disableFocusRipple:c,edge:p}),De=fs(pe);return O.jsxs(Cs,K({component:"span",className:Qe(De.root,r),centerRipple:!0,focusRipple:!c,disabled:Y,tabIndex:null,role:void 0,onFocus:Pe,onBlur:Mt,ownerState:pe,ref:s},x,{children:[O.jsx(gs,K({autoFocus:a,checked:o,defaultChecked:u,className:De.input,disabled:Y,id:Bt?y:void 0,name:P,onChange:Tt,readOnly:B,ref:b,required:R,ownerState:pe,tabIndex:N,type:z},z==="checkbox"&&f===void 0?{}:{value:f},g)),v?i:m]}))}),xs=bs,vs=ye(O.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),ys=ye(O.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),Ss=ye(O.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function ks(n){return Ve("MuiCheckbox",n)}const Ms=Ue("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),fe=Ms,Ts=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],Bs=n=>{const{classes:t,indeterminate:s,color:a,size:o}=n,i={root:["root",s&&"indeterminate",`color${Z(a)}`,`size${Z(o)}`]},r=Ye(i,ks,t);return K({},t,r)},Rs=ve(xs,{shouldForwardProp:n=>Xe(n)||n==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(n,t)=>{const{ownerState:s}=n;return[t.root,s.indeterminate&&t.indeterminate,t[`size${Z(s.size)}`],s.color!=="default"&&t[`color${Z(s.color)}`]]}})(({theme:n,ownerState:t})=>K({color:(n.vars||n).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:n.vars?`rgba(${t.color==="default"?n.vars.palette.action.activeChannel:n.vars.palette[t.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Et(t.color==="default"?n.palette.action.active:n.palette[t.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.color!=="default"&&{[`&.${fe.checked}, &.${fe.indeterminate}`]:{color:(n.vars||n).palette[t.color].main},[`&.${fe.disabled}`]:{color:(n.vars||n).palette.action.disabled}})),ws=O.jsx(ys,{}),Is=O.jsx(vs,{}),Es=O.jsx(Ss,{}),_s=l.forwardRef(function(t,s){var a,o;const i=_t({props:t,name:"MuiCheckbox"}),{checkedIcon:r=ws,color:u="primary",icon:d=Is,indeterminate:c=!1,indeterminateIcon:p=Es,inputProps:m,size:y="medium",className:g}=i,b=Je(i,Ts),P=c?p:d,T=c?p:r,j=K({},i,{color:u,indeterminate:c,size:y}),D=Bs(j);return O.jsx(Rs,K({type:"checkbox",inputProps:K({"data-indeterminate":c},m),icon:l.cloneElement(P,{fontSize:(a=P.props.fontSize)!=null?a:y}),checkedIcon:l.cloneElement(T,{fontSize:(o=T.props.fontSize)!=null?o:y}),ownerState:j,ref:s,className:Qe(D.root,g)},b,{classes:D}))}),Ps=_s;function He({value:n,onChange:t,...s}){const[a,o]=l.useState(n);l.useEffect(()=>{o(n)},[n]);const i=()=>t(a);return e(ut,{value:a,onChange:r=>o(r.target.value),onBlur:i,onKeyDown:r=>r.key==="Enter"&&!s.multiline&&i(),...s})}function ft(n){const{database:t}=S();return re(t.builds,n??"")}function Be(n){const{database:t}=S();return re(t.buildTcs,n??"")}function se(n){const{database:t}=S();return re(t.teams,n)}var Re={},Ds=ke;Object.defineProperty(Re,"__esModule",{value:!0});var xe=Re.default=void 0,zs=Ds(Se()),$s=O,Ls=(0,zs.default)((0,$s.jsx)("path",{d:"M12 12.75c1.63 0 3.07.39 4.24.9 1.08.48 1.76 1.56 1.76 2.73V18H6v-1.61c0-1.18.68-2.26 1.76-2.73 1.17-.52 2.61-.91 4.24-.91zM4 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm1.13 1.1c-.37-.06-.74-.1-1.13-.1-.99 0-1.93.21-2.78.58C.48 14.9 0 15.62 0 16.43V18h4.5v-1.61c0-.83.23-1.61.63-2.29zM20 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm4 3.43c0-.81-.48-1.53-1.22-1.85-.85-.37-1.79-.58-2.78-.58-.39 0-.76.04-1.13.1.4.68.63 1.46.63 2.29V18H24v-1.57zM12 6c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}),"Groups");xe=Re.default=Ls;const ae=l.createContext({presetIndex:0,setPresetIndex:()=>{}}),he=l.createContext({teamId:"",team:{}});function W(){return l.useContext(he)}const Ct=l.createContext({buildType:"equipped",buildId:""});function I(){return l.useContext(Ct)}function Os({teamId:n,children:t}){const s=se(n),a=ie(s.teamMetadata,0),o=ie(s.teamMetadata,1),i=ie(s.teamMetadata,2),r=ie(s.teamMetadata,3),u=l.useMemo(()=>es([...ts(s.teamMetadata.map(d=>d==null?void 0:d.characterKey).filter(d=>!!d)),...a,...o,...i,...r,oe.common.lvl.add(80),oe.common.res.add(.1),oe.common.isBroken.add(0),oe.common.maxToughness.add(100),Pt.common.critMode.add("avg"),...s.conditionals.flatMap(({sheet:d,src:c,dst:p,condKey:m,condValues:y})=>y.flatMap((g,b)=>g?qe(`preset${b}`,Dt(d,c,p)(m,g)):[])),...s.bonusStats.flatMap(({tag:d,values:c})=>c.flatMap((p,m)=>qe(`preset${m}`,{tag:{...d},value:zt(p)})))]),[s,a,o,i,r]);return e(Hn.Provider,{value:u,children:t})}function ie(n,t){const s=n[t],a=pt(s==null?void 0:s.characterKey),o=Be(s==null?void 0:s.buildTcId),i=ft(s==null?void 0:s.buildId),r=Qn((s==null?void 0:s.buildType)==="equipped"?a==null?void 0:a.equippedLightCone:(s==null?void 0:s.buildType)==="real"?i==null?void 0:i.lightConeId:void 0),u=$t((s==null?void 0:s.buildType)==="equipped"?a==null?void 0:a.equippedRelics:(s==null?void 0:s.buildType)==="real"?i==null?void 0:i.relicIds:void 0),d=l.useMemo(()=>{const p=(s==null?void 0:s.buildType)==="tc"?o==null?void 0:o.lightCone:r;return p?ns(p.key,p.level,p.ascension,p.superimpose):[]},[s==null?void 0:s.buildType,o==null?void 0:o.lightCone,r]),c=l.useMemo(()=>{const p=o==null?void 0:o.relic;return(s==null?void 0:s.buildType)==="tc"&&p?cn(p):u?ln(Object.values(u).filter(Ze)):[]},[o==null?void 0:o.relic,s==null?void 0:s.buildType,u]);return l.useMemo(()=>a?ss(a.key,...as(a,t+1),...d,...c):[],[a,t,d,c])}function js(){const{database:n}=S(),{team:t,teamId:s}=W();return h(C,{sx:{display:"flex",gap:1,overflowX:"auto",overflowY:"visible",p:1},children:[t.frames.map((a,o)=>e(As,{frame:a,index:o},o)),e(C,{sx:{flexShrink:0},children:e(lt,{setOptTarget:a=>n.teams.set(s,o=>{o.frames=[...o.frames,{multiplier:1,tag:{...a,preset:`preset${o.frames.length}`}}]})})})]})}function As({frame:n,index:t}){const{presetIndex:s,setPresetIndex:a}=l.useContext(ae),o=te(),{setRead:i}=l.useContext(dt),r=l.useMemo(()=>new Lt(n.tag,"sum"),[n.tag]),u=l.useMemo(()=>{try{return(o==null?void 0:o.compute(r).val)??0}catch(p){return console.error("Error computing value:",p),0}},[o,r]),d=ge(n.tag.q??""),c=l.useCallback(p=>{p.altKey?i(r):a(t)},[t,r,a,i]);return e(M,{bgt:"light",sx:p=>({flexShrink:0,outline:s===t?`solid ${p.palette.success.main}`:void 0}),children:h(ne,{onClick:c,children:[h(C,{sx:{display:"flex",gap:1,alignItems:"stretch",p:1},children:[e(k,{children:t+1}),e(w,{orientation:"vertical"}),e(C,{sx:{display:"flex",alignItems:"center"},children:e(dn,{tag:n.tag})})]}),e(w,{}),e(C,{sx:{p:1,display:"flex",alignItems:"center",gap:1},children:h(k,{children:[n.multiplier," x ",et(u,d)]})})]})})}var we={},Ns=ke;Object.defineProperty(we,"__esModule",{value:!0});var gt=we.default=void 0,Fs=Ns(Se()),qs=O,Hs=(0,Fs.default)((0,qs.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");gt=we.default=Hs;function Ks({teamId:n,charKey:t}){const{t:s}=V("page_team"),a=tt(),o=nt(),i=st(o.breakpoints.down("md")),r=se(n);return r?e(At,{variant:"fullWidth",value:t??0,orientation:i?"vertical":"horizontal",sx:()=>({borderBottom:"1px rgb(200,200,200,0.3) solid","& .MuiTab-root:hover":{transition:"background-color 0.25s ease",backgroundColor:"rgba(255,255,255,0.1)"},"& .Mui-selected":{color:"white !important"},"& .MuiTabs-indicator":{height:"4px",backgroundColor:"rgb(200,200,200,0.5)"},minHeight:"1em"}),children:r.teamMetadata.map((u,d)=>{const c=u==null?void 0:u.characterKey;return e(Ot,{icon:c?e(jt,{size:1.5,src:Wn(ht(c),"icon")}):e(gt,{}),iconPosition:"start",value:c??d,disabled:!u,label:c?e(k,{children:s(`charNames_gen:${c}`)}):`Character ${d+1}`,onClick:()=>c&&a(`/teams/${n}/${c}`),sx:{p:1,minHeight:"1em"}},d)})}):null}var Ie={},Ws=ke;Object.defineProperty(Ie,"__esModule",{value:!0});var bt=Ie.default=void 0,Gs=Ws(Se()),Vs=O,Us=(0,Gs.default)((0,Vs.jsx)("path",{d:"M22 24H2v-4h20v4zM13.06 5.19l3.75 3.75L7.75 18H4v-3.75l9.06-9.06zm4.82 2.68-3.75-3.75 1.83-1.83c.39-.39 1.02-.39 1.41 0l2.34 2.34c.39.39.39 1.02 0 1.41l-1.83 1.83z"}),"BorderColor");bt=Ie.default=Us;function Xs({teamId:n}){const t=se(n);return e(C,{display:"flex",flexDirection:"column",gap:1,children:t.teamMetadata.map((s,a)=>e(Js,{teamMetadataIndex:a,teamId:n},`${a}_${s==null?void 0:s.characterKey}`))})}const Js=l.memo(function({teamMetadataIndex:t,teamId:s}){var r;const{database:a}=S(),o=se(s);function i(u){if(u===""){a.teams.set(s,c=>c.teamMetadata[t]=void 0);return}a.chars.getOrCreate(u);const d=o.teamMetadata.findIndex(c=>(c==null?void 0:c.characterKey)===u);if(d===-1)a.teams.set(s,c=>{c.teamMetadata[t]={characterKey:u}});else{if(d===t)return;const c=o.teamMetadata[d],p=o.teamMetadata[t];a.teams.set(s,m=>{m.teamMetadata[t]=c,m.teamMetadata[d]=p})}}return e(un,{charKey:((r=o.teamMetadata[t])==null?void 0:r.characterKey)??"",setCharKey:i})});function Qs(){const{t:n}=V("page_team"),{teamId:t,team:s}=W(),{database:a}=S(),[o,i]=l.useState(!1),r=d=>{a.teams.set(t,{name:d})},u=d=>{a.teams.set(t,{description:d})};return h(ce,{children:[e(ne,{onClick:()=>i(!0),children:e(Nt,{placement:"top",title:h(C,{children:[h(C,{sx:{display:"flex",color:"info.light",gap:1},children:[e(bt,{}),e(k,{children:e("strong",{children:n("team.editNameDesc")})})]}),!!s.description&&e(k,{children:s.description})]}),children:e(_,{sx:{display:"flex",justifyContent:"center","&:hover":{color:"info.light"},py:1},children:h(k,{variant:"h5",sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"center",textShadow:"#000 0 0 10px !important"},children:[e(xe,{}),s.name]})})})}),e(U,{open:o,onClose:()=>i(!1),children:h(M,{children:[e(A,{title:n("team.editNameDesc"),avatar:e(xe,{}),titleTypographyProps:{variant:"h6"},action:e(G,{onClick:()=>i(!1),children:e(X,{})})}),e(w,{}),e(_,{children:h(C,{display:"flex",flexDirection:"column",gap:2,sx:{mt:2},children:[e(He,{label:n("team.name"),value:s.name,onChange:d=>r(d),autoFocus:!0}),e(He,{label:n("team.desc"),value:s.description,onChange:d=>u(d),multiline:!0,minRows:4}),e(Xs,{teamId:t})]})})]})})]})}const xt=210,vt=2,yt=l.createContext(xt);function Ys({teamId:n,characterKey:t,headerRef:s}){return e(C,{ref:s,sx:{overflow:"visible",top:vt,position:"sticky",zIndex:101},children:h(M,{sx:a=>({outline:`solid ${a.palette.secondary.main}`}),children:[e(Qs,{}),e(w,{}),e(js,{}),e(w,{}),e(Ks,{teamId:n,charKey:t})]})})}function Zs(){const{database:n}=S(),{presetIndex:t}=l.useContext(ae),{teamId:s,team:{bonusStats:a}}=W(),{characterKey:o}=I(),i=r=>{const u=ea(r,o);n.teams.setBonusStat(s,u,0,t)};return t?h(M,{children:[e(A,{title:"Bonus Stats"}),e(w,{}),e(_,{children:h(F,{spacing:1,children:[a.map(({tag:r,values:u},d)=>e(sa,{tag:r,value:u[t],setValue:c=>n.teams.setBonusStat(s,r,c,t),onDelete:()=>n.teams.setBonusStat(s,r,0,t),setTag:c=>n.teams.setBonusStat(s,c,0,t)},JSON.stringify(r)+d)),e(na,{onSelect:i})]})})]}):null}function ea(n,t){return{src:t,dst:t,et:"own",q:n,qt:"premod",sheet:"agg"}}const ta=["hp","hp_","def","def_","atk","atk_","spd","spd_","dmg_","enerRegen_","brEffect_","crit_","crit_dmg_","eff_","eff_res_","heal_"];function na({tag:n={},onSelect:t}){var s;return e(ue,{title:(n&&((s=hn.subset(n)[0])==null?void 0:s.title))??"Add Bonus Stat",children:ta.map(a=>e(ee,{onClick:()=>t(a),children:a},a))})}function sa({tag:n,setTag:t,value:s,setValue:a,onDelete:o}){var r;const i=(r=n.name||n.q)==null?void 0:r.endsWith("_");return e(M,{bgt:"light",children:h(_,{sx:{display:"flex",gap:1,justifyContent:"space-around"},children:[e(at,{sx:{m:"auto"},children:n.q}),n.q==="dmg_"&&e(aa,{tag:n,setElementalType:u=>{const{elementalType:d,...c}=n;t(u?{...c,elementalType:u}:c)}}),e(le,{float:!0,value:s,sx:{flexBasis:150,flexGrow:1,height:"100%"},onChange:a,placeholder:"Stat Value",size:"small",inputProps:{sx:{textAlign:"right"}},InputProps:{endAdornment:h(Te,{position:"end",sx:{ml:0},children:[i?"%":void 0," ",e(G,{"aria-label":"Delete Bonus Stat",onClick:o,edge:"end",children:e(os,{fontSize:"small"})})]})}})]})})}function aa({tag:n,setElementalType:t}){return h(ue,{title:n.elementalType??"No Element",children:[e(ee,{onClick:()=>t(null),children:"No Element"}),Ft.map(s=>e(ee,{onClick:()=>t(s),children:s},s))]})}function oa({onClose:n}){const{database:t}=S(),{characterKey:s}=I(),[a,o]=be(),[i,r]=be(),u=l.useMemo(()=>a&&t.builds.getBuildIds(s),[a,t,s]),d=l.useMemo(()=>i&&t.buildTcs.getBuildTcIds(s),[i,t,s]);return l.useEffect(()=>t.builds.followAny(o),[t.builds,o]),l.useEffect(()=>t.buildTcs.followAny(r),[t.buildTcs,r]),h(M,{bgt:"dark",children:[e(A,{title:"Builds",action:n?e(G,{onClick:n,children:e(X,{})}):null}),e(w,{}),e(_,{children:h(F,{spacing:1,children:[e(k,{variant:"h6",children:"Equipped build"}),e(ia,{}),e(k,{variant:"h6",children:"Other builds"}),u.map(c=>e(ra,{buildId:c},c)),e(k,{variant:"h6",children:"TC builds"}),e(L,{fullWidth:!0,onClick:()=>t.buildTcs.new(qt(s)),children:"New TC Build"}),d.map(c=>e(ca,{buildTcId:c},c))]})})]})}function Ee(n,t=""){const{database:s}=S(),{characterKey:a,buildType:o,buildId:i,buildTcId:r}=I(),{teamId:u}=W();return l.useMemo(()=>({active:o==="equipped"?o===n:o==="real"?i===t:o==="tc"&&r===t,onActive:()=>{s.teams.set(u,d=>{const c=d.teamMetadata.find(p=>(p==null?void 0:p.characterKey)===a);if(!c){console.error(`Teammate data not found for character ${a}`);return}c.buildType=n,n==="real"&&t?c.buildId=t:n==="tc"&&t&&(c.buildTcId=t)})}}),[i,r,o,a,s.teams,t,n,u])}function ia(){const n=Me(),{equippedRelics:t,equippedLightCone:s}=n,{active:a,onActive:o}=Ee("equipped");return e(_e,{name:"Equipped",onActive:o,active:a,buildGrid:e(de,{relicIds:t,lightConeId:s})})}function ra({buildId:n}){const t=ft(n),{relicIds:s,lightConeId:a,name:o,description:i}=t,{active:r,onActive:u}=Ee("real",n);return e(_e,{name:o,description:i,onActive:u,active:r,buildGrid:e(de,{relicIds:s,lightConeId:a})})}function _e({name:n,description:t,buildGrid:s,active:a,onActive:o}){const i=l.useCallback(()=>{},[]);return h(M,{sx:r=>({outline:a?`solid ${r.palette.success.main}`:void 0}),children:[h(C,{display:"flex",children:[e(ne,{onClick:i,children:e(A,{title:n,subheader:t})}),e(C,{display:"flex",alignContent:"center",sx:{padding:1},children:e(L,{size:"small",color:"success",onClick:o,disabled:a,children:"Set Active"})})]}),e(w,{}),e(_,{children:s})]})}function ca({buildTcId:n}){const t=Be(n),{name:s="ERROR",description:a="ERROR"}=t??{},{active:o,onActive:i}=Ee("tc",n);return e(_e,{name:s,description:a,onActive:i,active:o,buildGrid:e(St,{buildTcId:n})})}function St({buildTcId:n}){const{database:t}=S(),s=Be(n),{lightCone:a,relic:o}=s,[i,r,u]=J(),[d,c,p]=J(),[m,y,g]=J(),[b,P,T]=J(),j=l.useCallback(f=>{t.buildTcs.set(n,x=>({lightCone:{...x.lightCone,...f}}))},[n,t.buildTcs]),D=l.useCallback((f,x)=>{t.buildTcs.set(n,v=>({relic:{...v.relic,slots:{...v.relic.slots,[f]:{...v.relic.slots[f],...x}}}}))},[n,t.buildTcs]),B=l.useCallback((f,x)=>{t.buildTcs.set(n,v=>({relic:{...v.relic,substats:{...v.relic.substats,stats:{...v.relic.substats.stats,[f]:x}}}}))},[n,t.buildTcs]),R=l.useCallback(f=>{t.buildTcs.set(n,x=>({relic:{...x.relic,substats:{...x.relic.substats,type:f}}}))},[n,t.buildTcs]),N=l.useCallback((f,x)=>{t.buildTcs.set(n,v=>({relic:{...v.relic,sets:{...v.relic.sets,[f]:x}}}))},[n,t.buildTcs]),z=l.useCallback(f=>{t.buildTcs.set(n,x=>{const v={...x.relic.sets};return delete v[f],{relic:{...x.relic,sets:v}}})},[n,t.buildTcs]);return h(C,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[e(la,{show:i,onClose:u,lightCone:a,onUpdate:j}),a?e(pn,{bgt:"light",lightCone:a,onClick:r}):e(mn,{bgt:"light",onClick:r}),e(ma,{show:b,onClose:T,sets:o.sets,setSets:N,removeSet:z}),e(fn,{bgt:"light",sets:o.sets,onClick:P}),e(da,{show:d,onClose:p,slots:o.slots,setSlot:D}),e(Cn,{bgt:"light",slots:o.slots,onClick:c}),e(ha,{stats:o.substats.stats,show:m,onClose:g,type:o.substats.type,setType:R,setStat:B}),e(me,{onClick:y,relic:o,keys:["hp","hp_","def","def_"],bgt:"light"}),e(me,{onClick:y,relic:o,keys:["atk","atk_","crit_","crit_dmg_"],bgt:"light"}),e(me,{onClick:y,relic:o,keys:["spd","eff_","eff_res_","brEffect_"],bgt:"light"})]})}function la({lightCone:n={},onUpdate:t,show:s,onClose:a}){return e(U,{open:s,onClose:a,children:e(cs,{onClose:a,lightCone:n,setLightCone:t,hideLocation:!0})})}function da({slots:n,show:t,onClose:s,setSlot:a}){return e(U,{open:t,onClose:s,containerProps:{maxWidth:"sm"},children:h(M,{children:[e(A,{title:"TC Build Relic Slots Editor",action:e(G,{onClick:s,children:e(X,{})})}),e(w,{}),e(_,{children:e(F,{spacing:1,children:Object.entries(n).map(([o,{level:i,statKey:r,rarity:u}])=>e(ua,{slotKey:o,level:i,statKey:r,rarity:u,setStatKey:d=>a(o,{statKey:d}),setRarity:d=>a(o,{rarity:d}),setLevel:d=>a(o,{level:d})},o))})})]})})}function ua({slotKey:n,level:t,rarity:s,statKey:a,setStatKey:o,setRarity:i,setLevel:r}){return h(C,{sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"space-between"},children:[e(is,{slotKey:n}),e(ls,{rarity:s,onRarityChange:i,showNumber:!0}),e(C,{sx:{flexGrow:1},children:e(ds,{dropdownButtonProps:{fullWidth:!0},slotKey:n,statKey:a,setStatKey:o})}),e(le,{value:t,inputProps:{sx:{width:"2ch"},max:Ht[s],min:0},InputProps:{startAdornment:e(Te,{position:"start",children:"Level"})},size:"small",onChange:r})]})}function ha({show:n,onClose:t,stats:s,setStat:a}){return e(U,{open:n,onClose:t,containerProps:{maxWidth:"sm"},children:h(M,{children:[e(A,{title:"TC Build Substats Editor",action:e(G,{onClick:t,children:e(X,{})})}),e(w,{}),e(_,{children:e(F,{spacing:1,children:e(C,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",rowGap:1,columnGap:2},children:Object.entries(s).map(([o,i])=>e(pa,{statKey:o,value:i,setValue:r=>a(o,r)},o))})})})]})})}function pa({statKey:n,value:t,setValue:s}){return h(C,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"space-between"},children:[e(Gn,{statKey:n}),e(le,{value:t,onChange:s,float:ge(n)==="%",size:"small",inputProps:{sx:{width:"4em",textAlign:"right"},min:0,max:9999},InputProps:{endAdornment:ge(n)||e(C,{width:"0.8em",component:"span"})}})]})}function ma({show:n,onClose:t,sets:s,setSets:a,removeSet:o}){const[i,r]=l.useState(null),u=l.useCallback(c=>{c&&(Kt(c)?a(c,2):Wt(c)&&r(c))},[a]),d=l.useCallback(c=>{i&&(a(i,c),r(null))},[i,a]);return e(U,{open:n,onClose:t,containerProps:{maxWidth:"sm"},children:h(M,{children:[e(A,{title:"TC Build Relic Sets Editor",action:e(G,{onClick:t,children:e(X,{})})}),e(w,{}),e(_,{children:h(F,{spacing:1,children:[Object.entries(s).map(([c,p])=>h(C,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(rs,{setKey:c}),e(at,{children:p}),e(G,{size:"small",onClick:()=>o(c),children:e(us,{})})]},c)),h(C,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(mt,{size:"small",relicSetKey:i??"",setRelicSetKey:u,sx:{flexGrow:1},label:i??""}),h(Gt,{children:[e(L,{disabled:!i,onClick:()=>d(2),children:"2"}),e(L,{disabled:!i,onClick:()=>d(4),children:"4"})]})]})]})})]})})}function fa(){const{team:n}=W(),t=n.conditionals,[s,a]=l.useState(""),o=l.useMemo(()=>{const i=t.map(r=>r.sheet).filter(Vt);return s&&i.push(s),[...new Set(i)].sort(r=>r===s?-1:1)},[t,s]);return h(F,{spacing:1,sx:{pt:1},children:[e(Yn,{lcKey:s,setLCKey:a,label:"Search Light Cone"}),e(C,{children:e(E,{container:!0,columns:3,spacing:1,children:o.map(i=>e(E,{item:!0,xs:1,children:e(gn,{lcKey:i})},i))})})]})}function Ca(n){const{database:t}=S();return re(t.generatedBuildList,n)}const ga=l.memo(function(){const{optConfig:t}=l.useContext(ot),s=Ca(t.generatedBuildListId??"");return e(F,{spacing:1,children:s==null?void 0:s.builds.map((a,o)=>e(M,{children:h(_,{children:[h(C,{sx:{display:"flex",justifyContent:"space-between",gap:1},children:[h(k,{children:["Build ",o+1,": ",et(a.value)]}),e(ba,{build:a})]}),e(de,{relicIds:a.relicIds,lightConeId:a.lightConeId})]})},`${o}-${a.lightConeId}-${Object.values(a.relicIds).join("-")}`))})});function ba({build:{relicIds:n,lightConeId:t}}){const{t:s}=V("build"),[a,o]=l.useState(""),[i,r,u]=J(),[d,c]=l.useState(!1),{database:p}=S(),{teamId:m}=W(),{characterKey:y}=I(),g=b=>{b.preventDefault(),d||p.builds.new({characterKey:y,name:a,teamId:m,relicIds:n,lightConeId:t}),o(""),u()};return h(ce,{children:[e(L,{color:"info",size:"small",startIcon:e(bn,{}),onClick:r,children:s("createBuildReal.button")}),e(U,{open:i,onClose:u,disableRestoreFocus:!0,children:h(M,{children:[e(A,{title:s("createBuildReal.title"),action:e(G,{onClick:u,children:e(X,{})})}),e(w,{}),h(_,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e(k,{children:s("createBuildReal.desc")}),h(C,{display:"flex",alignItems:"center",sx:{ml:-1},children:[e(Ps,{size:"small",checked:d,onChange:()=>c(!d)}),e(k,{children:"Create a new TC Build"})]}),h("form",{onSubmit:g,children:[e(ut,{value:a,onChange:b=>o(b.target.value),autoFocus:!0,margin:"dense",label:s("createBuildReal.label"),fullWidth:!0}),h(C,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e(L,{onClick:u,children:s("createBuildReal.cancel")}),e(L,{type:"submit",color:"success",disabled:!a,children:s("createBuildReal.create")})]})]})]})]})})]})}function xa(){const{database:n}=S(),{teamId:t}=l.useContext(he),s=I(),a=s.optConfigId,o=l.useCallback(()=>{a||n.teams.set(t,i=>{const r=i.teamMetadata.find(u=>(u==null?void 0:u.characterKey)===s.characterKey);if(r){const u=n.optConfigs.new();r.optConfigId=u}})},[t,s.characterKey,n,a]);return a?h(Ut,{optConfigId:a,children:[e(va,{}),e(ga,{})]}):e(M,{children:e(A,{title:h("span",{children:["Optimize this team for ",s.characterKey]}),action:e(L,{onClick:o,children:"Optimize"})})})}function va(){const{t:n}=V("optimize"),{database:t}=S(),s=te(),{team:a}=l.useContext(he),{characterKey:o}=I(),[i,r]=l.useState(8),[u,d]=l.useState(void 0),{optConfig:c,optConfigId:p}=l.useContext(ot),m=l.useMemo(()=>t.relics.values.reduce((B,R)=>(B[R.slotKey].push(R),B),{head:[],hands:[],feet:[],body:[],sphere:[],rope:[]}),[t.relics.values]),y=l.useMemo(()=>{const{path:B}=Un(o);return t.lightCones.values.filter(({key:R})=>{const{path:N}=Zn(R);return B===N})},[o,t.lightCones.values]),g=l.useMemo(()=>Object.values(m).reduce((B,R)=>B*R.length,1)*y.length,[y.length,m]),[b,P]=l.useState(!1),T=l.useRef(()=>{});l.useEffect(()=>()=>T.current(),[]);const j=l.useCallback(async()=>{if(!s)return;const B=new Promise(f=>T.current=f);d(void 0),P(!0);const R=(c.statFilters??[]).filter(({disabled:f})=>!f).map(({tag:f,value:x,isMax:v})=>({tag:f,value:x,isMax:v})),N=xn(o,s,a.frames,10,R,[],[],[],y,m,i,d);B.then(()=>N.terminate("user cancelled"));let z;try{z=await N.results}catch{return}finally{T.current=()=>{},P(!1)}z.length&&t.optConfigs.newOrSetGeneratedBuildList(p,{builds:z.slice(0,5).map(({ids:f,value:x})=>({lightConeId:f[0],relicIds:it(Xt,(v,q)=>f[q+1]),value:x})),buildDate:Date.now()})},[s,c.statFilters,o,a.frames,y,m,i,t.optConfigs,p]),D=l.useCallback(()=>{T.current(),P(!1)},[T]);return h(M,{children:[e(A,{title:n("optimize"),action:h(C,{children:[e(vn,{numWorkers:i,setNumWorkers:r}),e(L,{onClick:b?D:j,color:b?"error":"primary",startIcon:b?e(X,{}):e(yn,{}),children:n(b?"cancel":"optimize")})]})}),e(w,{}),h(_,{children:[e(Sn,{}),u&&e(ya,{progress:u,totalPermutations:g})]})]})}function ya({progress:n,totalPermutations:t}){const{t:s}=V("optimize");return h(C,{children:[h(k,{children:[s("computed"),": ",n.computed.toLocaleString()," /"," ",(n.computed+n.remaining).toLocaleString()]}),h(k,{children:[s("computed + skipped"),":"," ",(n.computed+n.skipped).toLocaleString()," /"," ",t.toLocaleString()]}),e(kn,{variant:"determinate",value:(n.computed+n.skipped)/t*100})]})}function Sa(){const{team:n}=W(),t=n.conditionals,[s,a]=l.useState(""),o=l.useMemo(()=>{const i=t.map(r=>r.sheet).filter(Jt);return s&&i.push(s),[...new Set(i)].sort(r=>r===s?-1:1)},[t,s]);return h(F,{spacing:1,sx:{pt:1},children:[e(mt,{relicSetKey:s,setRelicSetKey:a,label:"Search Relic Set"}),e(C,{children:e(E,{container:!0,columns:3,spacing:1,children:o.map(i=>e(E,{item:!0,xs:1,children:e(Mn,{setKey:i})},i))})})]})}const ka={xs:12,sm:6,md:4};function Ma(){const{characterKey:n}=I(),t=te(),s=["basic","skill","ult","talent","technique","overworld","bonusAbility1","bonusAbility2","bonusAbility3",...Tn],a=nt(),o=st(a.breakpoints.up("lg")),i=Rn[n],r=(t==null?void 0:t.compute(Q.char.eidolon).val)??0,u=l.useMemo(()=>i&&Bn.map(d=>{const c=i[d];return c?e(Ke,{talentKey:d,sheetElement:c},d):null}),[i]);if(!(!i||!t))return e(ce,{children:h(E,{container:!0,spacing:1,children:[o&&h(E,{item:!0,xs:12,md:12,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[e(We,{eidolon:r}),u&&u.map((d,c)=>e(C,{sx:{opacity:r>=c+1?1:.5},children:d},c))]}),e(E,{item:!0,xs:12,md:12,lg:9,container:!0,spacing:1,children:s.map(d=>{const c=i[d];return c?e(E,{item:!0,...ka,children:e(Ke,{talentKey:d,sheetElement:c})},d):null})}),!o&&e(E,{item:!0,xs:12,md:12,lg:3,container:!0,spacing:1,children:e(E,{item:!0,xs:12,children:e(We,{eidolon:r})})})]})})}function Ke({sheetElement:n,talentKey:t}){const s=te(),{characterKey:a}=I(),{database:o}=S(),{img:i,title:r,subtitle:u,documents:d}=n,c=l.useMemo(()=>s?je(t)?Ae[t].disabled(s):Ne(t)?Fe[t].disabled(s):!1:!1,[s,t]),p=l.useMemo(()=>{if(s){if(je(t)&&Ae[t].onClickable(s))return()=>o.chars.set(a,g=>{const b=wn(t);g.statBoosts={...g.statBoosts,[b]:!g.statBoosts[b]}});if(Ne(t)&&Fe[t].onClickable(s))return()=>o.chars.set(a,g=>{const b=In(t);g.bonusAbilities={...g.bonusAbilities,[b]:!g.bonusAbilities[b]}});if(En(t)){const g=_n(t),b=(s==null?void 0:s.compute(Q.char.eidolon).val)??0;return()=>o.chars.set(a,{eidolon:g===b?g-1:g})}}},[t,s,o.chars,a]),m=l.useCallback(g=>e(ne,{onClick:p,children:g}),[p]);let y=null;return y=null,zn(t)&&(y=e(Ta,{talentKey:t,dropDownButtonProps:{sx:{borderRadius:0}},setTalent:g=>o.chars.set(a,b=>{b[t]=g})})),h(M,{bgt:"light",sx:{height:"100%",opacity:c?.5:1},children:[y,h(C,{sx:{p:1},children:[e(Pn,{condition:!!p,wrapper:m,children:h(E,{container:!0,sx:{flexWrap:"nowrap"},children:[i&&e(E,{item:!0,children:e(C,{component:$e?$e:"img",src:i,sx:{width:60,height:"auto"}})}),h(E,{item:!0,flexGrow:1,sx:{pl:1},children:[e(k,{variant:"subtitle1",children:r}),u&&e(k,{variant:"subtitle2",children:u})]})]})}),d.map((g,b)=>e(Dn,{document:g,collapse:!0},b))]})]})}function We({eidolon:n}){const{t}=V("characters_gen"),{characterKey:s}=I(),{database:a}=S();return e(ue,{fullWidth:!0,title:h("span",{children:[t("eidolonLvl")," ",n]}),color:"primary",children:rt(0,Qt).map(o=>e(ee,{selected:n===o,disabled:n===o,onClick:()=>a.chars.set(s,{eidolon:o}),children:h("span",{children:[t("eidolonLvl")," ",o]})},o))})}function Ta({talentKey:n,setTalent:t,dropDownButtonProps:s}){const{t:a}=V("common_gen"),o=Me(),i=te();if(!i||!o)return null;const r=0,u=i.compute(Q.char[n]).val,d=i.compute(Q.char.ascension).val;return e(ue,{fullWidth:!0,title:h("span",{children:[a("lv")," ",u]}),color:"primary",...s,children:rt(1,Yt[d]).map(c=>e(ee,{selected:o[n]===c,disabled:o[n]===c,onClick:()=>t(c),children:h("span",{children:[a("lv")," ",c+r]})},c))})}const Ba=0,Ce=33,kt=l.createContext(0);function Ra(){const{presetIndex:n}=l.useContext(ae),{team:t}=W(),s=l.useMemo(()=>t.frames[n]?[["combo",`Edit Combo ${n+1}`,e(Ia,{},"combo")],["char","Character",e(Ge,{},"char")],["talent","Talent",e(Ma,{},"talent")],["relicCond","Relic Conditionals",e(Sa,{},"relicCond")],["lightConeCond","Light Cone Conditionals",e(fa,{},"lightConeCond")],["opt","Optimize",e(Ea,{},"opt")]]:[["char","Character",e(Ge,{})]],[t,n]);return e(kt.Provider,{value:s.length,children:e(F,{gap:1,children:s.map(([a,o,i],r)=>e(wa,{title:o,index:r,children:i},a))})})}function wa({index:n,title:t,children:s}){const[a,o]=$n(),i=l.useContext(kt),r=l.useContext(yt);return h(ce,{children:[e(M,{sx:u=>({outline:`solid ${u.palette.secondary.main}`,position:"sticky",top:r+n*Ce,bottom:Ba+(i-1-n)*Ce,zIndex:100}),children:e(ne,{onClick:o,sx:{px:1},children:e(k,{variant:"h6",children:t})})}),e(C,{ref:a,sx:{scrollMarginTop:r+(n+1)*Ce},children:s})]})}function Ia(){const{database:n}=S(),{presetIndex:t,setPresetIndex:s}=l.useContext(ae),{team:a,teamId:o}=W(),i=l.useMemo(()=>a.frames[t],[a,t]),r=d=>{n.teams.set(o,c=>{c.frames=[...c.frames],c.frames[t]={...c.frames[t],...d},c.frames.length?c.frames.length<=t&&s(c.frames.length-1):s(0)})},u=()=>{n.teams.set(o,d=>{d.frames=d.frames.filter((c,p)=>p!==t)})};return i?h(C,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(le,{value:i.multiplier,onChange:d=>r({multiplier:d}),size:"small",InputProps:{startAdornment:e(Te,{position:"start",children:"Multi x "})}}),e(lt,{optTarget:i.tag,setOptTarget:d=>r({tag:d})}),e(L,{size:"small",color:"error",onClick:u,startIcon:e(hs,{}),children:"Remove"})]}):null}function Ge(){const n=Me(),{key:t}=n,[s,a]=l.useState(void 0);return h(F,{spacing:1,children:[h(C,{sx:{display:"flex",gap:1},children:[h(C,{sx:{minWidth:"350px"},children:[e(Xn,{character:n}),e(Jn,{characterKey:s,onClose:()=>a(void 0)}),e(L,{fullWidth:!0,disabled:!t,onClick:()=>t&&a(t),children:"Edit Character"})]}),e(_a,{})]}),e(Zs,{}),e(Ln,{formulasRead:Q.listing.formulas,buffsRead:Q.listing.buffs})]})}function Ea(){const{buildType:n}=I();return n==="tc"?null:e(xa,{})}function _a(){const n=I(),{database:t}=S(),{buildType:s,buildId:a,buildTcId:o}=n,[i,r]=be(),u=l.useMemo(()=>i&&t.teams.getActiveBuildName(n),[t.teams,i,n]);l.useEffect(()=>{let m=()=>{};return s==="real"&&(m=t.builds.follow(a,r)),s==="tc"&&(m=t.buildTcs.follow(o,r)),()=>m()},[a,o,s,t,r]);const[d,c,p]=J();return h(M,{sx:{width:"100%"},children:[e(za,{show:d,onClose:p}),e(A,{title:u,action:e(L,{onClick:c,size:"small",children:"Change Build"})}),e(w,{}),e(_,{children:s==="tc"?e(Da,{}):e(Pa,{})})]})}function Pa(){const n=I(),{database:t}=S(),{relicIds:s,lightConeId:a}=l.useMemo(()=>t.teams.getTeamActiveBuild(n),[t.teams,n]);return e(de,{relicIds:s,lightConeId:a})}function Da(){const n=I();return n.buildType!=="tc"?null:e(St,{buildTcId:n.buildTcId})}function za({show:n,onClose:t}){return e(U,{open:n,onClose:t,containerProps:{maxWidth:"xl"},children:e(oa,{onClose:t})})}const $a=e(ct,{variant:"rectangular",width:"100%",height:1e3});function no(){const{database:n}=S(),{teamId:t}=Zt(),s=!t||!n.teams.keys.includes(t);return l.useEffect(()=>{s||n.teams.set(t,{lastEdit:Date.now()})},[t,n.teams,s]),s?e(on,{to:"/teams"}):e(C,{display:"flex",flexDirection:"column",gap:1,children:e(l.Suspense,{fallback:$a,children:t&&e(La,{teamId:t})})})}function La({teamId:n}){const t=tt(),{database:s}=S(),[a,o]=l.useState(0),i=l.useMemo(()=>({presetIndex:a,setPresetIndex:o}),[a,o]),r=se(n),{teamMetadata:u}=r,{params:{characterKey:d}}=en({path:"/teams/:teamId/:characterKey",end:!1})??{params:{}},c=l.useMemo(()=>{const f=u.findIndex(x=>x&&x.characterKey===d);return f===-1?0:f},[u,d]),p=l.useMemo(()=>u[c],[u,c]),m=p==null?void 0:p.characterKey;l.useEffect(()=>{m&&m!==d&&t(`${m}`,{replace:!0})},[m,d,p,t]);const{t:y}=V(["charNames_gen","page_character"]);On(l.useMemo(()=>{const f=y(m?"charNames_gen:Character":"Team Settings");return`${r.name} - ${f}`},[m,y,r.name]));const g=l.useMemo(()=>({teamId:n,team:r}),[r,n]),b=l.useMemo(()=>{const f=r.teamMetadata.filter(Ze).map(({characterKey:v})=>v);m&&tn(f,m);const x=it(f,v=>e(Vn,{genderedKey:ht(v)}));return{srcDisplay:x,dstDisplay:x}},[r.teamMetadata,m]),P=l.useMemo(()=>r.conditionals.map(({sheet:f,src:x,dst:v,condKey:q,condValues:$})=>({sheet:f,src:x,dst:v,condKey:q,condValue:$[a]})),[a,r.conditionals]),T=l.useCallback((f,x,v,q,$)=>{!nn(f)||!Le(v)||!(q===null||Le(q))||!sn(f,x)||s.teams.setConditional(n,f,x,v,q,$,a)},[s.teams,a,n]),j=l.useMemo(()=>({src:m,dst:m,preset:`preset${a}`}),[m,a]),[D,B]=l.useState(),R=l.useMemo(()=>({read:D,setRead:B}),[D]),{height:N,ref:z}=jn();return e(he.Provider,{value:g,children:e(Kn.Provider,{value:j,children:e(ae.Provider,{value:i,children:e(Os,{teamId:n,children:e(An.Provider,{value:b,children:e(Nn.Provider,{value:P,children:e(Fn.Provider,{value:T,children:h(dt.Provider,{value:R,children:[e(qn,{}),h(C,{sx:{display:"flex",gap:1,flexDirection:"column",mx:1,mt:2},children:[e(Ys,{headerRef:z,teamId:n,characterKey:m}),e(yt.Provider,{value:(N||xt)+vt,children:p&&e(Ct.Provider,{value:p,children:e(Oa,{})})})]})]})})})})})})})})}function Oa(){const{characterKey:n}=I(),t=pt(n);return t?e(an.Provider,{value:t,children:e(rn,{children:e(Oe,{path:":characterKey",children:e(Oe,{path:"*",index:!0,element:e(Ra,{})})})})}):e(ct,{variant:"rectangular",width:"100%",height:1e3})}export{no as default};
