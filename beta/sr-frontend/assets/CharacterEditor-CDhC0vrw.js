import{bU as re,bV as ie,bW as V,bX as $,bY as S,bZ as le,b_ as ce,b$ as ue,r as m,c0 as de,c1 as pe,j as D,f as me,c2 as fe,c3 as he,a$ as ge,c4 as A,s as ve,u as be,V as P,ah as Ce,a4 as b,o as s,aD as xe,c5 as ke,p as c,z as N,N as O,B as C,T as p,c6 as _e,t as ye,A as z,a6 as Se,D as je,w as F,i as G,k as U,S as Be,a1 as De,c7 as Pe,aa as g,y as R}from"./index-SHvKIHba.js";import{M as q,D as H,c as h,C as W,a as Ee,E as Ie,b as Me,d as X,T as w,S as Te}from"./StatDisplay-DsrC3GaE.js";import{s as $e,c as Ae}from"./index-Dp3Z0RuH.js";import{C as Oe,b as Re,a as x,P as we}from"./UploadCard-BvoW0y1M.js";import{C as Le}from"./CardActionArea-LUpL1Zdh.js";import{C as Y,G as d}from"./Grid-CargbIeK.js";const Ve=["component","direction","spacing","divider","children","className","useFlexGap"],Ne=re(),ze=ie("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root});function Fe(t){return fe({props:t,name:"MuiStack",defaultTheme:Ne})}function Ge(t,e){const a=m.Children.toArray(t).filter(Boolean);return a.reduce((n,o,r)=>(n.push(o),r<a.length-1&&n.push(m.cloneElement(e,{key:`separator-${r}`})),n),[])}const Ue=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],qe=({ownerState:t,theme:e})=>{let a=V({display:"flex",flexDirection:"column"},$({theme:e},S({values:t.direction,breakpoints:e.breakpoints.values}),n=>({flexDirection:n})));if(t.spacing){const n=le(e),o=Object.keys(e.breakpoints.values).reduce((l,u)=>((typeof t.spacing=="object"&&t.spacing[u]!=null||typeof t.direction=="object"&&t.direction[u]!=null)&&(l[u]=!0),l),{}),r=S({values:t.direction,base:o}),i=S({values:t.spacing,base:o});typeof r=="object"&&Object.keys(r).forEach((l,u,k)=>{if(!r[l]){const y=u>0?r[k[u-1]]:"column";r[l]=y}}),a=ce(a,$({theme:e},i,(l,u)=>t.useFlexGap?{gap:A(n,l)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${Ue(u?r[u]:t.direction)}`]:A(n,l)}}))}return a=ue(e.breakpoints,a),a};function He(t={}){const{createStyledComponent:e=ze,useThemeProps:a=Fe,componentName:n="MuiStack"}=t,o=()=>he({root:["root"]},l=>ge(n,l),{}),r=e(qe);return m.forwardRef(function(l,u){const k=a(l),_=de(k),{component:y="div",direction:K="column",spacing:ee=0,divider:M,children:T,className:te,useFlexGap:se=!1}=_,ne=pe(_,Ve),oe={direction:K,spacing:ee,useFlexGap:se},ae=o();return D.jsx(r,V({as:y,ownerState:oe,ref:u,className:me(ae.root,te)},ne,{children:M?Ge(T,M):T}))})}const We=He({createStyledComponent:ve("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root}),useThemeProps:t=>be({props:t,name:"MuiStack"})}),Z=We;function J(t){const{database:e}=P();return Ce(e.chars,t)}function Q(t){return b.char[t]}function ft(t,e,a,n=0){switch(e){case"eidolon":return Object.fromEntries(b.char[t].rankMap[a].params.map((o,r)=>[r+1,o]));case"basic":case"skill":case"ult":case"talent":case"technique":return Object.fromEntries(b.char[t].skillTree[e].skillParamList[n].map((o,r)=>[r+1,o[a]]));case"bonusAbility1":case"bonusAbility2":case"bonusAbility3":return Object.fromEntries(b.char[t].skillTree[e].skillParamList[n][a].map((o,r)=>[r+1,o]))}}function Xe(t,e){const n=Ye(t,e).levels;if(!(n!=null&&n.length))throw new Error(`No stat boost levels found for character ${t}`);const o=Object.entries(n[0].stats??{});if(!o.length)throw new Error(`No stats found in stat boost for character ${t}`);const[r,i]=o[0];return{statKey:r,value:i}}function Ye(t,e){const{skillTree:a}=Q(t);return a[`statBoost${e}`]}function v({characterKey:t,abilityKey:e,dropDownButtonProps:a={}}){const n=J(t),{database:o}=P(),r=e.charAt(0).toUpperCase()+e.slice(1);return s(H,{title:`${r} Lv. ${(n==null?void 0:n[e])??1}`,disabled:!n,...a,children:!!t&&xe(1,ke[e][(n==null?void 0:n.ascension)??0]).map(i=>c(q,{selected:(n==null?void 0:n[e])===i,disabled:(n==null?void 0:n[e])===i,onClick:()=>o.chars.set(t,{[e]:i}),children:[r," Lv. ",i]},`${e}_${i}`))})}function Ze(){const t=m.useContext(Oe),e=m.useContext(Re);return m.useMemo(()=>t==null?void 0:t.withTag(e),[t,e])}const Je=["hp","atk","def","spd","crit_","crit_dmg_","brEffect_","heal_","enerRegen_","eff_","eff_res_"];function ht({character:t,onClick:e}){const a=Ze()??$e(Ae(t,1));return s(Z,{children:c(N,{children:[e?s(Le,{onClick:e,children:s(L,{character:t})}):s(L,{character:t}),s(x,{}),s(Y,{children:Je.map(n=>s(Qe,{calc:a,statKey:n,characterKey:t.key},n))})]})})}function L({character:t}){const{key:e,eidolon:a,level:n,ascension:o}=t,r=X(e),{damageType:i,path:f,rarity:l}=Q(e);return c(C,{sx:{display:"flex"},children:[s(C,{component:O?O:"img",alt:"Character Icon",src:h(r,"icon"),sx:{maxHeight:"10em",width:"auto"}}),c(C,{sx:{px:2,pt:1},children:[s(p,{variant:"h5",children:s(W,{genderedKey:r})}),s(p,{children:s(Ee,{stars:l,inline:!0})}),c(p,{children:["Lv.",_e(n,o)," Eidolon: ",a]}),s(we,{pathKey:f}),s(ye,{color:i,children:s(Ie,{ele:i})})]})]})}function Qe({characterKey:t,calc:e,statKey:a}){return c(p,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"space-between"},children:[s(Me,{statKey:a}),c("span",{children:[z(e.withTag({src:t,dst:t}).compute(Se.final[a]).val,a).toFixed(je(a)),F(a)]})]})}var E={},Ke=U;Object.defineProperty(E,"__esModule",{value:!0});var j=E.default=void 0,et=Ke(G()),tt=D,st=(0,et.default)((0,tt.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");j=E.default=st;var I={},nt=U;Object.defineProperty(I,"__esModule",{value:!0});var B=I.default=void 0,ot=nt(G()),at=D,rt=(0,ot.default)((0,at.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");B=I.default=rt;function gt({characterKey:t,onClose:e}){return s(De,{open:!!t,onClose:e,children:s(m.Suspense,{fallback:s(Be,{variant:"rectangular",width:"100%",height:1e3}),children:t&&s(it,{characterKey:t})})})}function it({characterKey:t}){const e=J(t),a=X(t),{database:n}=P();return s(N,{children:c(Y,{sx:{display:"flex",flexDirection:"column",gap:1},children:[s(p,{variant:"h3",children:s(W,{genderedKey:a})}),s(w,{type:"number",label:"Level",variant:"outlined",inputProps:{min:1,max:90},value:(e==null?void 0:e.level)||0,onChange:o=>n.chars.set(t,{level:parseInt(o.target.value)}),disabled:!e}),s(w,{type:"number",label:"Ascension",variant:"outlined",inputProps:{min:0,max:6},value:(e==null?void 0:e.ascension)||0,onChange:o=>n.chars.set(t,{ascension:parseInt(o.target.value)}),disabled:!e}),s(H,{title:`Eidolon Lv. ${(e==null?void 0:e.eidolon)??0}`,fullWidth:!1,disabled:!e,children:Pe.map(o=>c(q,{selected:(e==null?void 0:e.eidolon)===o,disabled:(e==null?void 0:e.eidolon)===o,onClick:()=>n.chars.set(t,{eidolon:o}),children:["Eidolon Lv. ",o]},o))}),c(Z,{spacing:1,children:[s(p,{variant:"h6",children:"Abilites"}),s(x,{}),c(d,{container:!0,gap:1,children:[s(d,{item:!0,children:s(v,{characterKey:t,abilityKey:"basic",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(a,"basic_0")})}})}),s(d,{item:!0,children:s(v,{characterKey:t,abilityKey:"skill",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(a,"skill_0")})}})}),s(d,{item:!0,children:s(v,{characterKey:t,abilityKey:"ult",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(a,"ult_0")})}})}),s(d,{item:!0,children:s(v,{characterKey:t,abilityKey:"talent",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(a,"talent_0")})}})})]}),s(p,{variant:"h6",children:"Bonus Abilities"}),s(x,{}),s(d,{container:!0,gap:1,children:Object.entries((e==null?void 0:e.bonusAbilities)??{}).map(([o,r])=>s(d,{item:!0,children:s(R,{color:r?"success":"primary",onClick:()=>{n.chars.set(t,{bonusAbilities:{...e==null?void 0:e.bonusAbilities,[o]:!r}})},startIcon:r?s(j,{}):s(B,{}),children:s(g,{size:2,src:h(a,`bonusAbility${o}`),sideMargin:!0})})},o))}),s(p,{variant:"h6",children:"Stat Boosts"}),s(x,{}),s(d,{container:!0,gap:1,children:Object.entries((e==null?void 0:e.statBoosts)??{}).map(([o,r])=>{const{statKey:i,value:f}=Xe(t,o);return s(d,{item:!0,children:c(R,{color:r?"success":"primary",onClick:()=>{n.chars.set(t,{statBoosts:{...e==null?void 0:e.statBoosts,[o]:!r}})},startIcon:r?s(j,{}):s(B,{}),children:[s(Te,{statKey:i,iconProps:{sx:{ml:-1,mr:.5}}}),c(C,{children:[z(f,i),F(i)]})]})},o)})})]})]})})}export{gt as C,Z as S,ht as a,Ze as b,B as c,j as d,He as e,ft as f,Q as g,J as u};
