import{V as x,a3 as b,o as s,aY as O,bq as F,p as l,r as h,z as _,N as v,B as f,T as u,br as G,t as W,A as D,a5 as H,D as U,w as T,S as q,a0 as y,bs as R,a9 as p,y as I}from"./index-DaCOgWx5.js";import{c,C as A,a as V,E as Y,b as J,d as M,S as Q}from"./StatDisplay-ej4AHlPQ.js";import{u as X,s as Z,c as K,P as tt}from"./PathIcon-CmPKqY9U.js";import{M as P,D as k,b as st,c as et,e as g,f as $,a as S,s as w,t as E}from"./UploadCard-Dp3rYxk4.js";import{C as nt}from"./CardActionArea-Dm5d3m98.js";import{C as j,G as d}from"./Grid-C_21xBoU.js";function L(e){const{database:t}=x();return X(t.chars,e)}function N(e){return b.char[e]}function gt(e,t,o,n=0){return Object.fromEntries(t==="eidolon"?b.char[e].rankMap[o].params.map((i,a)=>[a+1,i]):b.char[e].skillTree[t].skillParamList[n].map((i,a)=>[a+1,i[o]]))}function it(e,t){const n=ot(e,t).levels;if(!(n!=null&&n.length))throw new Error(`No stat boost levels found for character ${e}`);const i=Object.entries(n[0].stats??{});if(!i.length)throw new Error(`No stats found in stat boost for character ${e}`);const[a,r]=i[0];return{statKey:a,value:r}}function ot(e,t){const{skillTree:o}=N(e);return o[`statBoost${t}`]}function m({characterKey:e,abilityKey:t,dropDownButtonProps:o={}}){const n=L(e),{database:i}=x(),a=t.charAt(0).toUpperCase()+t.slice(1);return s(k,{title:`${a} Lv. ${(n==null?void 0:n[t])??1}`,disabled:!n,...o,children:!!e&&O(1,F[t][(n==null?void 0:n.ascension)??0]).map(r=>l(P,{selected:(n==null?void 0:n[t])===r,disabled:(n==null?void 0:n[t])===r,onClick:()=>i.chars.set(e,{[t]:r}),children:[a," Lv. ",r]},`${t}_${r}`))})}function at(){const e=h.useContext(st),t=h.useContext(et);return h.useMemo(()=>e==null?void 0:e.withTag(t),[e,t])}const rt=["hp","atk","def","spd","crit_","crit_dmg_","brEffect_","heal_","enerRegen_","eff_","eff_res_"];function Ct({character:e,onClick:t}){const o=at()??Z(K(e));return s($,{children:l(_,{children:[t?s(nt,{onClick:t,children:s(B,{character:e})}):s(B,{character:e}),s(g,{}),s(j,{children:rt.map(n=>s(lt,{calc:o,statKey:n,characterKey:e.key},n))})]})})}function B({character:e}){const{key:t,eidolon:o,level:n,ascension:i}=e,a=M(t),{damageType:r,path:C,rarity:z}=N(t);return l(f,{sx:{display:"flex"},children:[s(f,{component:v?v:"img",alt:"Character Icon",src:c(a,"icon"),sx:{maxHeight:"10em",width:"auto"}}),l(f,{sx:{px:2,pt:1},children:[s(u,{variant:"h5",children:s(A,{genderedKey:a})}),s(u,{children:s(V,{stars:z,inline:!0})}),l(u,{children:["Lv.",G(n,i)," Eidolon: ",o]}),s(tt,{pathKey:C}),s(W,{color:r,children:s(Y,{ele:r})})]})]})}function lt({characterKey:e,calc:t,statKey:o}){return l(u,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"space-between"},children:[s(J,{statKey:o}),l("span",{children:[D(t.withTag({src:e,dst:e}).compute(H.final[o]).val,o).toFixed(U(o)),T(o)]})]})}function bt({characterKey:e,onClose:t}){return s(y,{open:!!e,onClose:t,children:s(h.Suspense,{fallback:s(q,{variant:"rectangular",width:"100%",height:1e3}),children:e&&s(dt,{characterKey:e})})})}function dt({characterKey:e}){const t=L(e),o=M(e),{database:n}=x();return s(_,{children:l(j,{sx:{display:"flex",flexDirection:"column",gap:1},children:[s(u,{variant:"h3",children:s(A,{genderedKey:o})}),s(S,{type:"number",label:"Level",variant:"outlined",inputProps:{min:1,max:90},value:(t==null?void 0:t.level)||0,onChange:i=>n.chars.set(e,{level:parseInt(i.target.value)}),disabled:!t}),s(S,{type:"number",label:"Ascension",variant:"outlined",inputProps:{min:0,max:6},value:(t==null?void 0:t.ascension)||0,onChange:i=>n.chars.set(e,{ascension:parseInt(i.target.value)}),disabled:!t}),s(k,{title:`Eidolon Lv. ${(t==null?void 0:t.eidolon)??0}`,fullWidth:!1,disabled:!t,children:R.map(i=>l(P,{selected:(t==null?void 0:t.eidolon)===i,disabled:(t==null?void 0:t.eidolon)===i,onClick:()=>n.chars.set(e,{eidolon:i}),children:["Eidolon Lv. ",i]},i))}),l($,{spacing:1,children:[s(u,{variant:"h6",children:"Abilites"}),s(g,{}),l(d,{container:!0,gap:1,children:[s(d,{item:!0,children:s(m,{characterKey:e,abilityKey:"basic",dropDownButtonProps:{startIcon:s(p,{size:1.5,sideMargin:!0,src:c(o,"basic_0")})}})}),s(d,{item:!0,children:s(m,{characterKey:e,abilityKey:"skill",dropDownButtonProps:{startIcon:s(p,{size:1.5,sideMargin:!0,src:c(o,"skill_0")})}})}),s(d,{item:!0,children:s(m,{characterKey:e,abilityKey:"ult",dropDownButtonProps:{startIcon:s(p,{size:1.5,sideMargin:!0,src:c(o,"ult_0")})}})}),s(d,{item:!0,children:s(m,{characterKey:e,abilityKey:"talent",dropDownButtonProps:{startIcon:s(p,{size:1.5,sideMargin:!0,src:c(o,"talent_0")})}})})]}),s(u,{variant:"h6",children:"Bonus Abilities"}),s(g,{}),s(d,{container:!0,gap:1,children:Object.entries((t==null?void 0:t.bonusAbilities)??{}).map(([i,a])=>s(d,{item:!0,children:s(I,{color:a?"success":"primary",onClick:()=>{n.chars.set(e,{bonusAbilities:{...t==null?void 0:t.bonusAbilities,[i]:!a}})},startIcon:a?s(w,{}):s(E,{}),children:s(p,{size:2,src:c(o,`bonusAbility${i}`),sideMargin:!0})})},i))}),s(u,{variant:"h6",children:"Stat Boosts"}),s(g,{}),s(d,{container:!0,gap:1,children:Object.entries((t==null?void 0:t.statBoosts)??{}).map(([i,a])=>{const{statKey:r,value:C}=it(e,i);return s(d,{item:!0,children:l(I,{color:a?"success":"primary",onClick:()=>{n.chars.set(e,{statBoosts:{...t==null?void 0:t.statBoosts,[i]:!a}})},startIcon:a?s(w,{}):s(E,{}),children:[s(Q,{statKey:r,iconProps:{sx:{ml:-1,mr:.5}}}),l(f,{children:[D(C,r),T(r)]})]})},i)})})]})]})})}export{bt as C,Ct as a,N as b,at as c,gt as g,L as u};
