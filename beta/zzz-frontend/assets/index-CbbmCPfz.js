import{bo as m,aA as b,b9 as q,ba as J,e as W,a as n,j as e,T as h,c as p,$ as V,G as s,Y as Z,C as S,u as Y,r as a,n as F,cV as Q,B as u,cd as X,k as w,b as f,bh as ee,cW as te}from"./index-yBxn32Fv.js";const ae=m(b.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),ne=m(b.jsx("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download"),oe=m(b.jsx("path",{d:"M9 3 5 6.99h3V14h2V6.99h3L9 3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99h-3z"}),"ImportExport"),re=m(b.jsx("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload");var k={},se=J;Object.defineProperty(k,"__esModule",{value:!0});var O=k.default=void 0,le=se(q()),ce=b,de=(0,le.default)((0,ce.jsx)("path",{d:"M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"}),"ContentPaste");O=k.default=de;function ie(){const{t:l}=W("page_settings");return n(S,{bgt:"light",children:[e(p,{sx:{py:1},children:e(h,{variant:"subtitle1",children:l("DatabaseCard.title")})}),e(V,{}),e(p,{sx:{display:"flex",flexDirection:"column",gap:2},children:e(s,{container:!0,spacing:2,columns:{xs:1,md:2},children:Z(0,3).map(x=>e(s,{item:!0,xs:1,children:e(ue,{index:x})},x))})})]})}function ue({index:l}){const{databases:x,database:g,setDatabase:j}=Y(),t=x[l],[{name:r,lastEdit:E},I]=a.useState(t.dbMeta.get());a.useEffect(()=>t.dbMeta.follow((i,y)=>I(y)),[t]),a.useEffect(()=>I(t.dbMeta.get()),[t]);const c=g===t,[H,$,M]=F(),{t:o}=W("page_settings"),_=t.chars.keys.length,B=t.discs.keys.length,z=t.wengines.keys.length,C=!!(_||B||z),R=a.useCallback(()=>navigator.clipboard.writeText(JSON.stringify(t.exportZOD())).then(()=>alert("Copied database to clipboard.")).catch(console.error),[t]),L=a.useCallback(()=>{window.confirm(`Are you sure you want to delete "${r}"?`)&&(t.clear(),t.toExtraLocalDB())},[t,r]),K=a.useCallback(()=>{const y=new Date().toISOString().split(".")[0].replace("T","_").replaceAll(":","-"),G=JSON.stringify(t.exportZOD()),P=`${r.trim().replaceAll(" ","_")}_${y}.json`,U="application/json;charset=utf-8",d=document.createElement("a");d.download=P,d.href=`data:${U},${encodeURIComponent(G)}`,d.target="_blank",document.body.appendChild(d),d.click(),document.body.removeChild(d)},[t,r]),N=a.useCallback(()=>{c||(g.toExtraLocalDB(),t.swapStorage(g),j(l,t))},[l,j,g,c,t]),[D,T]=a.useState(r);a.useEffect(()=>T(r),[r]);const v=a.useCallback(()=>{t.dbMeta.set({name:D}),t.toExtraLocalDB()},[D,t]),A=a.useCallback(i=>i.key==="Enter"&&v(),[v]);return n(S,{sx:{height:"100%",boxShadow:c?"0px 0px 0px 2px green inset":void 0},children:[n(p,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[e(Q,{value:D,sx:{borderRadius:1,px:1,flexGrow:1},onChange:i=>T(i.target.value),onBlur:v,onKeyDown:A}),!c&&e(u,{startIcon:e(oe,{}),onClick:N,color:"warning",children:o("DatabaseCard.button.swap")}),e(X,{color:c?"success":"secondary",sx:{alignSelf:"center"},label:c?o("DatabaseCard.currentDB"):`${o("DatabaseCard.title")} ${t.dbIndex}`})]}),e(V,{}),e(p,{children:n(w,{display:"flex",gap:2,children:[n(w,{flexGrow:1,children:[n(h,{noWrap:!0,children:[e(f,{t:o,i18nKey:"count.chars"})," ",e("strong",{children:_})]}),n(h,{noWrap:!0,children:[e(f,{t:o,i18nKey:"count.discs"})," ",e("strong",{children:B})]}),n(h,{noWrap:!0,children:[e(f,{t:o,i18nKey:"count.wengines"})," ",e("strong",{children:z})]})]}),n(w,{children:[n(s,{container:!0,spacing:1,columns:{xs:2},children:[e(s,{item:!0,xs:1,children:e(u,{fullWidth:!0,disabled:!C,color:"info",onClick:R,startIcon:e(O,{}),children:e(f,{t:o,i18nKey:"DatabaseCard.button.copy"})})}),n(s,{item:!0,xs:1,children:[e(ee,{open:H,onClose:M,children:e(te,{index:l,onReplace:M})}),e(u,{fullWidth:!0,component:"span",color:"info",startIcon:e(re,{}),onClick:$,children:o("DatabaseCard.button.upload")})]}),e(s,{item:!0,xs:1,children:e(u,{fullWidth:!0,disabled:!C,onClick:K,startIcon:e(ne,{}),children:o("DatabaseCard.button.download")})}),e(s,{item:!0,xs:1,children:e(u,{fullWidth:!0,disabled:!C,color:"error",onClick:L,startIcon:e(ae,{}),children:o("DatabaseCard.button.delete")})})]}),!!E&&e(h,{noWrap:!0,align:"center",style:{paddingTop:"1.5em"},children:e("strong",{children:new Date(E).toLocaleString()})})]})]})})]})}function pe(){return e(S,{sx:{my:1},children:e(p,{sx:{display:"flex",flexDirection:"column",gap:2},children:e(ie,{})})})}export{pe as default};
