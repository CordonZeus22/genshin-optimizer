import{e as I,a as s,k as n,j as e,c3 as j,a1 as y,T as m,c4 as _,c5 as A,c6 as F,c7 as z,F as $,r as o,aj as E,S as G,C as w,c8 as L,c9 as H,ax as O,ca as P,ab as q,cb as k,cc as Q,cd as U,ce as J,c as T,G as x,bT as b,cf as v,bM as V,bD as B,bN as X,cg as N,bf as Y,aa as Z,$ as K,bh as ee,bC as M,ch as te,U as W,ci as ae,u as re,cj as ne,aI as ie,p as se,B as le}from"./index-yBxn32Fv.js";import{a as D,b as f}from"./char-DV8NNv1W.js";import{b as ce,a as oe}from"./CharacterEditor-DLyaGwRE.js";import"./discSortUtil-C2nIE0tj.js";function de({characterKey:a}){const{t}=I("page_characters"),r=D(a),{rarity:l,specialty:c,attribute:i}=f(a),{level:d,core:h}=r;return s($,{children:[s(n,{display:"flex",gap:1.5,alignItems:"center",children:[e(y,{size:2,src:j(l)}),e(m,{variant:"h4",children:e(ce,{characterKey:a})}),e(_,{ele:i}),e(y,{size:2,src:A(c)})]}),s(n,{display:"flex",gap:3,alignItems:"center",children:[e(n,{children:e(m,{component:"span",variant:"h5",whiteSpace:"nowrap",fontStyle:"italic",fontWeight:"bold",fontSize:"1.625rem",sx:{textShadow:"none"},children:e("strong",{children:t("characterCard.charLevel",{level:d})})})}),s(n,{display:"flex",gap:1.5,marginLeft:"14px",alignItems:"center",children:[F.map((u,S)=>s(n,{position:"relative",children:[e(y,{size:2,src:z(u)}),e(n,{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",bottom:"-10px",left:"-4px",width:"1.7em",height:"1.7em",borderRadius:"1rem",fontWeight:"bold",fontSize:"0.8rem",sx:{background:"#1C1C1C"},children:r[u]})]},S)),s(n,{position:"relative",children:[e(y,{size:2,src:z("core")}),e(n,{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",bottom:"-10px",left:"-4px",width:"1.7em",height:"1.7em",borderRadius:"1rem",fontWeight:"bold",fontSize:"0.8rem",sx:{background:"#1C1C1C"},children:h})]})]})]})]})}function he({characterKey:a,onClick:t}){const r=D(a),l=o.useCallback(()=>a&&(t==null?void 0:t(a)),[a,t]),c=o.useCallback(i=>e(E,{onClick:l,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:i}),[l]);return e(o.Suspense,{fallback:e(G,{variant:"rectangular",width:"100%",height:300}),children:e(w,{bgt:"light",sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:"24px"},children:e(L,{condition:!!t,wrapper:c,children:r&&e(pe,{characterKey:a})})})})}function pe({characterKey:a}){const t=f(a);return s(w,{sx:{borderRadius:"20px",width:"100%"},children:[e(n,{sx:r=>({p:1,width:"100%",display:"flex",flexDirection:"column",gap:1,flexGrow:1,position:"relative",background:`${r.palette[t.attribute].main}`,height:"270px",padding:0}),children:e(H,{characterKey:a})}),e(n,{sx:r=>({padding:"8px 8px 8px 20px",width:"100%",display:"flex",flexDirection:"column",gap:1,flexGrow:1,position:"relative",background:"#1A263A"}),children:e(de,{characterKey:a})})]})}function ue({value:a,totals:t,onChange:r,...l}){const c=O(),i=!P(c.breakpoints.up("sm")),d=o.useMemo(()=>q([...k]),[]),h=o.useCallback(u=>()=>r(d(a,u)),[r,d,a]);return e(J,{exclusive:!0,value:a,...l,children:k.map(u=>e(Q,{value:u,sx:{p:i?1:void 0,minWidth:i?0:"6em",display:"flex",gap:i?0:1},onClick:h(u),children:s(n,{display:"flex",children:[e("strong",{children:u}),!i&&e(U,{label:t[u],size:"small"})]})},u))})}function xe({show:a,onHide:t,onSelect:r}){return e(fe,{show:a,onClose:()=>{t()},children:e(T,{sx:{flex:"1",overflow:"auto"},children:e(x,{container:!0,spacing:1,columns:{xs:2,sm:3,md:4,lg:5},children:b.map(c=>e(x,{item:!0,xs:1,children:e(w,{bgt:"light",sx:()=>({position:"relative",flexGrow:1,display:"flex",flexDirection:"column"}),children:e(me,{characterKey:c,onClick:()=>{t(),r(c)}})})},c))})})})}function fe({show:a,onClose:t,children:r}){const l=o.useMemo(()=>v(V,i=>b.forEach(d=>{const h=f(d).specialty;i[h].total++,b.includes(d)&&i[h].current++})),[]),c=o.useMemo(()=>v(B,i=>b.forEach(d=>{const h=f(d).attribute;i[h].total++,b.includes(d)&&i[h].current++})),[]);return e(ee,{open:a,onClose:t,containerProps:{sx:{height:"100vh",p:{xs:1}}},children:s(w,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[e(T,{sx:{display:"flex",flexDirection:"column",gap:1},children:s(n,{sx:{display:"flex",justifyContent:"space-between"},children:[s(n,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[e(X,{onChange:()=>{},value:["attack"],totals:l,size:"small"}),e(N,{onChange:()=>{},value:["fire"],totals:c,size:"small"})]}),e(Y,{sx:{ml:"auto"},onClick:()=>t(),children:e(Z,{})})]})}),e(K,{}),r]})})}function me({characterKey:a,onClick:t}){const{t:r}=I(["page_characters","charNames_gen"]),l=D(a),{rarity:c}=f(a),{level:i=1,promotion:d=0,mindscape:h=0}=l??{};return e(E,{onClick:t,children:s(n,{display:"flex",position:"relative",sx:{"&::before":{content:'""',display:"block",position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:.7}},width:"100%",children:[e(n,{flexShrink:1,sx:{maxWidth:{xs:"33%",lg:"30%"}},alignSelf:"flex-end",display:"flex",flexDirection:"column",zIndex:1,children:e(n,{component:M?M:"img",src:te(a,"circle"),width:"100%",height:"auto",maxWidth:256,sx:{mt:"auto"}})}),s(n,{flexGrow:1,sx:{pr:1,pt:1},display:"flex",flexDirection:"column",zIndex:1,justifyContent:"space-evenly",children:[e(m,{variant:"body2",sx:{flexGrow:1},children:e(W,{color:f(a).attribute,sx:{opacity:.85,textShadow:"0 0 5px gray"},children:r(`charNames_gen:${a}`)})}),l?s(n,{sx:{display:"flex",gap:1,alignItems:"center"},children:[s(n,{sx:{textShadow:"0 0 5px gray"},children:[e(m,{variant:"body2",component:"span",whiteSpace:"nowrap",children:r("characterCard.charLevel",{level:i})}),s(m,{variant:"body2",component:"span",color:"text.secondary",children:["/",ae[d]]})]}),s(m,{variant:"body2",children:["M",h]})]}):e(m,{component:"span",variant:"body2",children:e(W,{children:r("characterEditor.new")})}),e(y,{size:1.5,src:j(c)})]})]})})}const ge={xs:1,sm:1,md:1,lg:2,xl:3};function ve(){const{t:a}=I("page_characters"),{database:t}=re(),r=ne(),{params:{characterKey:l}}=ie({path:"/characters/:characterKey",end:!1})??{params:{}},{charKeys:c}=o.useMemo(()=>({charKeys:t.chars.keys}),[t]),i=o.useMemo(()=>l?b.includes(l)?l:(r("/characters"),null):null,[l,r]),[d,h]=o.useState(!1),u=o.useCallback(p=>{t.chars.get(p)||t.chars.getOrCreate(p),r(`/characters/${p}`)},[t.chars,r]),S=o.useMemo(()=>v(B,p=>Object.entries(t.chars.data).forEach(([g])=>{const C=f(g).attribute;p[C].total++,t.chars.keys.includes(g)&&p[C].current++})),[t]),R=o.useMemo(()=>v(k,p=>Object.entries(t.chars.data).forEach(([g])=>{const C=f(g).rarity;p[C].total++,t.chars.keys.includes(g)&&p[C].current++})),[t]);return s(n,{display:"flex",flexDirection:"column",gap:5,children:[i&&e(oe,{characterKey:i,onClose:()=>r("/characters")}),e(o.Suspense,{fallback:!1,children:e(xe,{show:d,onHide:()=>h(!1),onSelect:u})}),e(w,{children:e(T,{sx:{display:"flex",flexDirection:"column",gap:1},children:s(x,{container:!0,spacing:1,children:[e(x,{item:!0,children:"Wengine Toggle"}),e(x,{item:!0,children:e(N,{sx:{height:"100%"},onChange:()=>{},value:["fire"],totals:S,size:"small"})}),e(x,{item:!0,children:e(ue,{sx:{height:"100%"},onChange:()=>{},value:["S"],totals:R,size:"small"})}),e(x,{item:!0,flexGrow:1}),e(x,{item:!0,children:e(se,{autoFocus:!0,value:"term",onChange:()=>{},label:a("characterName"),size:"small",sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]})})}),e(le,{fullWidth:!0,onClick:()=>h(!0),color:"info",children:a("addNew")}),e(o.Suspense,{fallback:e(G,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:e(x,{container:!0,spacing:3,columns:ge,children:c.map(p=>e(x,{item:!0,xs:1,children:e(he,{characterKey:p,onClick:()=>r(`${p}`)})},p))})})]})}export{ve as default};
