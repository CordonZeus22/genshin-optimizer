import{j as e,bz as ge,ck as xe,e as y,a as c,cl as Q,T as f,cm as me,cn as we,co as Ce,k as o,cp as be,cq as ye,cr as ve,M as Se,bC as L,c3 as J,a1 as S,c4 as K,c5 as F,ci as Ie,cs as De,Y as H,G as w,aj as ee,ct as ke,ch as _e,cd as Ee,U as Ae,cu as Me,u as T,P,r as p,c7 as te,cv as Te,X as ne,Z as ie,b9 as ze,ba as We,aA as Be,f as je,h as Re,i as Le,ah as qe,c as D,bf as ae,aa as re,$ as q,S as k,D as Oe,cw as $e,C as _,cx as Fe,m as se,bh as ce,g as He,ai as oe,bS as Pe,bM as Ge,Q as Ne,cy as Ue,o as Xe,bt as Qe,n as z,cz as G,B as E,cA as le,F as N,cB as Ve,cj as Ye,a7 as Ze,cC as Je,c6 as Ke}from"./index-yBxn32Fv.js";import{g as et,b as W,u as tt,a as nt}from"./char-DV8NNv1W.js";import{i as it,d as at}from"./discSortUtil-C2nIE0tj.js";const rt={50:"#fffde7",100:"#fff9c4",200:"#fff59d",300:"#fff176",400:"#ffee58",500:"#ffeb3b",600:"#fdd835",700:"#fbc02d",800:"#f9a825",900:"#f57f17",A100:"#ffff8d",A200:"#ffff00",A400:"#ffea00",A700:"#ffd600"},st=rt;function de({characterKey:t}){return e(ge,{ns:"charNames_gen",key18:t})}function Wt({attribute:t}){return xe[t]}function ct({bgt:t,character:n}){const{t:a}=y("page_characters"),{key:i,level:s,core:r}=n,l=et(i,s,r),d=W(i),g=["anomMas_base","anomProf","atk_base","crit_","crit_dmg_","def_base","hp_base"],h=[...new Set(d.coreStats.flatMap(Object.keys))][1];return c(me,{bgt:t,sx:{width:"100%",borderRadius:0},children:[g.map(u=>e(Q,{children:e(V,{substat:u,value:l[u]})},u)),c(Q,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(f,{flexGrow:1,children:e("strong",{children:a("characterCard.coreStat")})}),r?e(V,{substat:h,value:d.coreStats[r-1][h]}):e(f,{children:e("strong",{children:a("characterCard.notUnlocked")})})]})]})}function V({substat:t,value:n}){if(!n)return null;const a=we(n,t).toFixed(Ce(t));return c(f,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",justifyContent:"space-between",fontWeight:"bold",gap:1},children:[c(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(ye,{statKey:t,iconProps:be}),ve[t]]}),c("span",{children:[a,Se(t)]})]})}function ot({mindscape:t,setMindscape:n}){const{t:a}=y("page_characters");return e(w,{container:!0,spacing:1,children:H(1,6).map(i=>e(w,{item:!0,xs:4,children:e(ee,{onClick:()=>n(i===t?i-1:i),style:{border:`1px solid ${t>=i?st[700]:ke[200]}`,borderRadius:"4px",overflow:"hidden",padding:"16px",textAlign:"center"},children:a("characterEditor.mindscape",{level:i})})},i))})}function lt({character:{level:t,promotion:n,key:a}}){return e(dt,{level:t,promotion:n,characterKey:a})}function dt({characterKey:t,level:n,promotion:a}){const{rarity:i}=W(t);return c(o,{sx:{display:"flex",position:"relative"},children:[c(o,{sx:{position:"absolute",width:"100%",height:"100%"},children:[e(f,{variant:"h6",sx:{position:"absolute",width:"100%",left:"50%",bottom:0,transform:"translate(-50%, -50%)",opacity:1,textAlign:"center"},children:e(S,{size:1.5,src:J(i)})}),e(o,{sx:{position:"absolute",left:"50%",bottom:"7%",transform:"translate(-50%, -50%)",opacity:.85,width:"100%",display:"flex",justifyContent:"center",px:1},children:e(ht,{characterKey:t})}),e(pt,{level:n,promotion:a})]}),e(o,{src:_e(t,"full"),component:L?L:"img",width:"100%",height:"auto"})]})}function ht({characterKey:t}){const{attribute:n,specialty:a}=W(t);return e(Ee,{color:n,sx:{height:"auto"},label:c(f,{variant:"h6",sx:{display:"flex",gap:1,alignItems:"center"},children:[e(K,{ele:n}),e(o,{sx:{whiteSpace:"normal",textAlign:"center"},children:e(de,{characterKey:t})}),e(S,{size:1.5,src:F(a)})]})})}function pt({level:t,promotion:n}){return e(f,{sx:{p:1,position:"absolute",right:0,top:0,opacity:.8},children:e(Ae,{children:Me(t,n)})})}function Bt({character:{level:t,promotion:n,key:a}}){const i=W(a);return c(o,{sx:{display:"flex",flexDirection:"column",width:"500px"},children:[e(ut,{characterKey:a,character:i}),e(ft,{characterKey:a,character:i,promotion:n,level:t})]})}function ut({characterKey:t,character:n}){const{attribute:a,id:i}=n;return c(o,{sx:r=>({width:"100%",height:"100%",position:"relative",display:"flex",background:`${r.palette[a].main}`,zIndex:1,overflow:"hidden"}),children:[c(o,{sx:{position:"absolute",left:"0",right:"0",display:"flex",transform:"rotate(10deg) translateX(-50%)",zIndex:2},children:[e(Y,{characterKey:t}),e(Y,{characterKey:t})]}),e(o,{src:`https://act-webstatic.hoyoverse.com/game_record/zzzv2/role_vertical_painting/role_vertical_painting_${i}.png`,component:L?L:"img",width:"100%",height:"auto",position:"relative",zIndex:"2"})]})}function ft({characterKey:t,character:n,promotion:a,level:i}){const{attribute:s,rarity:r,faction:l,specialty:d}=n;return c(o,{sx:{width:"100%",height:"100%",padding:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[c(o,{children:[c(o,{gap:2,sx:{display:"flex",alignItems:"center"},children:[e(S,{size:2,src:J(r)}),e(f,{variant:"h5",sx:{fontStyle:"italic",fontWeight:"900",whiteSpace:"nowrap",maxWidth:"230px",overflow:"hidden",textOverflow:"ellipsis"},children:e(de,{characterKey:t})}),e(K,{ele:s}),e(S,{size:2,src:F(d)})]}),c(o,{sx:{border:"2px #2B364D solid",borderRadius:"20px",width:"130px",display:"flex",marginTop:"16px"},children:[c(f,{sx:{fontWeight:"900",paddingLeft:"10px"},children:["Lv. ",i]}),c(f,{sx:{fontWeight:"900",color:"#1E78C8",paddingLeft:"14px"},children:["/ ",Ie[a]]})]})]}),e(o,{children:e(S,{size:5,src:De(l)})})]})}function Y({characterKey:t}){const{t:n}=y("charNames_gen");return e(o,{component:"span",sx:{color:"#000",marginTop:"20px",fontStyle:"italic",fontSize:"280px",lineHeight:"223px",whiteSpace:"nowrap",textTransform:"uppercase",display:"flex",justifyContent:"center",fontFamily:"Impact",opacity:.1,...{animation:"scroll 16s infinite linear","@keyframes scroll":{"0%":{transform:"translateX(-100%)"},"100%":{transform:"translateX(0)"}}}},children:n(`${t}`)})}function gt(){const{t}=y("page_characters"),{database:n}=T(),a=P(),{core:i=0,promotion:s=0,key:r}=a??{},l=p.useCallback(d=>r&&n.chars.set(r,{core:d}),[n,r]);return e(ie,{fullWidth:!0,title:t("core",{level:i}),color:"primary",startIcon:e(S,{src:te("core"),size:1.75,sideMargin:!0}),children:H(0,Te[s]).map(d=>e(ne,{selected:i===d,disabled:i===d,onClick:()=>l(d),children:t("core",{level:d})},d))})}var U={},xt=We;Object.defineProperty(U,"__esModule",{value:!0});var A=U.default=void 0,mt=xt(ze()),wt=Be,Ct=(0,mt.default)((0,wt.jsx)("path",{d:"M6.99 11 3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"}),"SwapHoriz");A=U.default=Ct;const bt={xs:2*3,sm:2*3,md:3*3,lg:4*3,xl:4*3};function he({disc:t,onChangeId:n,slotKey:a,show:i,onClose:s}){const{t:r}=y(["page_characters","disc"]),{database:l}=T(),d=t==null?void 0:t.id,g=p.useCallback((m,v)=>({...m,...v,slotKeys:[a]}),[a]),[h,u]=p.useReducer(g,{...it(),slotKeys:[a]}),[I,M]=je();p.useEffect(()=>l.discs.followAny(M),[l,M]);const B=Re(),b=p.useMemo(()=>at(),[]),x=l.discs.values.filter(m=>m.slotKey===h.slotKeys[0]).length,C=p.useMemo(()=>{const m=He(h,b);let v=l.discs.values.filter(m).map($=>$.id);return d&&l.discs.get(d)&&(v=v.filter($=>$!==d),v.unshift(d)),I&&v},[h,b,l.discs,d,I]),{numShow:X,setTriggerElement:pe}=Le(bt[B],C.length),O=p.useMemo(()=>C.slice(0,X),[C,X]),ue=C.length!==x?`${C.length}/${x}`:`${x}`,fe={numShowing:O.length,total:ue,t:r,namespace:"disc"},[j,R]=p.useState("");return p.useEffect(()=>{qe.includes(j)?(n(null),R(""),s()):j&&(n(j),R(""),s())},[n,s,j]),e(ce,{open:i,onClose:s,containerProps:{maxWidth:"xl"},children:c(_,{children:[c(D,{sx:{py:1,display:"flex",alignItems:"center"},children:[e(f,{variant:"h6",children:r("tabEquip.swapDisc")}),e(ae,{onClick:s,sx:{ml:"auto"},children:e(re,{})})]}),e(q,{}),e(D,{children:e(p.Suspense,{fallback:e(k,{variant:"rectangular",width:"100%",height:200}),children:e(Oe,{filterOption:h,filterOptionDispatch:u,filteredIds:C,disableSlotFilter:!0})})}),e(q,{}),c(D,{children:[e(o,{pb:1,display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:e($e,{showingTextProps:fe})}),e(o,{mt:1,children:e(p.Suspense,{fallback:e(k,{variant:"rectangular",width:"100%",height:300}),children:c(w,{container:!0,spacing:1,columns:{xs:2,md:3,lg:4},children:[d&&e(w,{item:!0,xs:1,children:e(_,{bgt:"light",sx:{width:"100%",height:"100%"},children:e(ee,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>R(a),children:c(o,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e(Fe,{sx:{fontSize:"10em"}}),e(f,{children:r("disc:button.unequipDisc")})]})})})}),O.map(m=>e(w,{item:!0,xs:1,sx:v=>({...d===m&&{"> .MuiCard-root":{outline:`solid ${v.palette.warning.main}`}}}),children:e(se,{disc:l.discs.get(m),onClick:d===m?void 0:()=>R(m)})},m))]})})}),C.length!==O.length&&e(k,{ref:m=>{m&&pe(m)},sx:{borderRadius:1,mt:1},variant:"rectangular",width:"100%",height:100})]})]})})}const Z={xs:1,sm:2,md:3,lg:3,xl:3};function yt({setWengine:t,setDisc:n}){const{database:a}=T(),i=p.useContext(oe),[s,r]=p.useState(),[l,d]=p.useState(""),g=p.useCallback(b=>{d(b)},[]),h=p.useCallback(b=>{r(b)},[]),u=Pe(i==null?void 0:i.equippedWengine),I=i?W(i.key).specialty:Ge[0],M=Ne(i==null?void 0:i.equippedDiscs),B=tt(s);return c(o,{children:[e(p.Suspense,{fallback:!1,children:l&&e(Ue,{wengineId:l,footer:!0,onClose:()=>d(""),extraButtons:e(kt,{wengineId:(u==null?void 0:u.id)||"",wengineTypeKey:I,onChangeId:t})})}),e(p.Suspense,{fallback:!1,children:B&&e(Xe,{disc:B,show:!!s,onShow:()=>r(s),onClose:()=>r(void 0),cancelEdit:()=>r(void 0)})}),e(w,{item:!0,columns:Z,container:!0,spacing:1,sx:{padding:"16px 8px"},children:u&&u.id&&a.wengines.keys.includes(u.id)?e(Qe,{wengineId:u.id,onEdit:()=>g(u.id),extraButtons:e(Dt,{wengineId:u.id,wengineTypeKey:I,onChangeId:t})}):e(vt,{wengineId:"",wengineTypeKey:I,onChangeId:t})}),e(w,{item:!0,columns:Z,container:!0,spacing:1,children:!!M&&Object.entries(M).map(([b,x])=>e(w,{item:!0,xs:1,children:x!=null&&x.id&&a.discs.keys.includes(x.id)?e(se,{disc:x,extraButtons:e(It,{disc:x,slotKey:b,onChangeId:C=>n(b,C)}),onEdit:()=>h(x.id),onLockToggle:()=>a.discs.set(x.id,({lock:C})=>({lock:!C}))}):e(St,{slotKey:b,onChangeId:C=>n(b,C)})},(x==null?void 0:x.id)||b))})]})}function vt({wengineId:t,wengineTypeKey:n,onChangeId:a}){const[i,s,r]=z();return c(_,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[e(D,{children:c(f,{children:[e(S,{src:F(n)})," "]})}),e(q,{}),c(o,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[e(G,{wengineId:t,wengineTypeKey:n,show:i,onClose:r,onChangeId:a}),e(E,{onClick:s,color:"info",sx:{borderRadius:"1em"},children:e(A,{sx:{height:100,width:100}})})]})]})}function St({slotKey:t,onChangeId:n}){const[a,i,s]=z(),{t:r}=y("disc");return c(_,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[e(D,{children:e(f,{children:r("slotName",{slotKey:t})})}),e(q,{}),c(o,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[e(he,{disc:void 0,slotKey:t,show:a,onClose:s,onChangeId:n}),e(E,{onClick:i,color:"info",sx:{borderRadius:"1em"},children:e(A,{sx:{height:100,width:100}})})]})]})}function It({disc:t,slotKey:n,onChangeId:a}){const{t:i}=y("page_characters"),[s,r,l]=z();return c(N,{children:[e(le,{title:e(f,{children:i("tabEquip.swapDisc")}),placement:"top",arrow:!0,children:e(E,{color:"info",size:"small",onClick:r,"aria-label":i("tabEquip.swapDisc"),children:e(A,{})})}),e(he,{disc:t,slotKey:n,show:s,onClose:l,onChangeId:a})]})}function Dt({wengineId:t,wengineTypeKey:n,onChangeId:a}){const{t:i}=y("page_characters"),[s,r,l]=z();return c(N,{children:[e(le,{title:e(f,{children:i("tabEquip.swapWengine")}),placement:"top",arrow:!0,children:e(E,{color:"info",size:"small",onClick:r,children:e(A,{})})}),e(G,{wengineId:t,wengineTypeKey:n,onChangeId:a,show:s,onClose:l})]})}function kt({wengineId:t,wengineTypeKey:n,onChangeId:a}){const{t:i}=y("page_characters"),[s,r,l]=z();return c(N,{children:[e(E,{color:"info",onClick:r,startIcon:e(A,{}),children:i("tabEquip.swapWengine")}),e(G,{wengineId:t,wengineTypeKey:n,onChangeId:a,show:s,onClose:l})]})}function _t({skillKey:t}){const{database:n}=T(),{t:a}=y("page_characters"),i=P(),{[t]:s=0,promotion:r=0,key:l}=i??{},d=p.useCallback(g=>l&&n.chars.set(l,{[t]:g}),[n,l,t]);return e(ie,{fullWidth:!0,title:a(t,{level:s}),color:"primary",startIcon:e(S,{src:te(t),size:1.75,sideMargin:!0}),children:H(1,Ve[r]).map(g=>e(ne,{selected:s===g,disabled:s===g,onClick:()=>d(g),children:a(t,{level:g})},g))})}function Et({onClose:t}){const{t:n}=y(["page_characters"]),a=Ye(),{database:i}=T(),s=P(),{key:r,equippedDiscs:l,equippedWengine:d}=s,g=p.useCallback(async()=>{const h=n(`${r}`);window.confirm(n("removeCharacter",{value:h}))&&(i.chars.remove(r),a("/characters"))},[i,a,r,n]);return c(o,{display:"flex",flexDirection:"column",gap:1,children:[c(o,{display:"flex",gap:1,children:[e(E,{color:"error",onClick:()=>g(),startIcon:e(Ze,{}),sx:{marginLeft:"auto"},children:n("characterEditor.delete")}),!!t&&e(ae,{onClick:t,children:e(re,{})})]}),e(o,{children:c(w,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[e(w,{item:!0,xs:8,sm:5,md:4,lg:3,children:c(_,{bgt:"light",sx:{height:"100%",display:"flex",flexDirection:"column",gap:1},children:[e(lt,{character:s}),e(o,{sx:{px:1},children:e(Je,{level:s.level,milestone:s.promotion,setBoth:h=>{i.chars.set(r,h)}})}),e(ct,{bgt:"light",character:s}),e(f,{sx:{textAlign:"center",pb:-1},variant:"h6",children:n("characterEditor.mindscapeTitle")}),e(o,{sx:{px:1},children:e(ot,{mindscape:s.mindscape,setMindscape:h=>i.chars.set(r,{mindscape:h})})})]})}),c(w,{item:!0,xs:12,sm:7,md:8,lg:9,sx:{display:"flex",flexDirection:"column",gap:1},children:[e(o,{children:c(w,{container:!0,columns:3,spacing:1,children:[Ke.map(h=>e(w,{item:!0,xs:1,children:e(_t,{skillKey:h},h)},h)),e(w,{item:!0,xs:1,children:e(gt,{})},"core")]})}),e(o,{children:e(yt,{setWengine:h=>{h?i.wengines.set(h,{location:r}):i.wengines.set(d,{location:""})},setDisc:(h,u)=>{u?i.discs.set(u,{location:r}):i.discs.set(l[h],{location:""})}})})]})]})})]})}function jt({characterKey:t,onClose:n}){return e(ce,{open:!!t,onClose:n,children:e(p.Suspense,{fallback:e(k,{variant:"rectangular",width:"100%",height:1e3}),children:t&&e(At,{characterKey:t,onClose:n},t)})})}function At({characterKey:t,onClose:n}){const a=nt(t);return e(_,{children:e(D,{sx:{display:"flex",flexDirection:"column",gap:1},children:e(p.Suspense,{fallback:e(k,{variant:"rectangular",width:"100%",height:1e3}),children:a?e(oe.Provider,{value:a,children:e(Et,{onClose:n})}):e(k,{variant:"rectangular",width:"100%",height:1e3})})})})}export{Wt as A,Bt as C,yt as E,jt as a,de as b};
