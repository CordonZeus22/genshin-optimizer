import{y as E,d as e,e as n,a9 as ne,ar as Pe,a as j,z as N,r as o,bP as re,h as u,G as h,i as b,cn as Ge,co as qe,c2 as Ve,cp as He,V as ye,cq as Ue,bH as Ye,al as ue,Y as Je,cr as pe,cs as Qe,ct as ae,L,af as se,ag as U,M as A,N as k,T as W,cu as Ze,c0 as O,cm as K,q as Y,f as z,cv as Ce,a7 as Xe,cw as et,ac as I,am as le,ah as ce,aa as be,cx as tt,cy as at,p as nt,cz as rt,cA as st,as as lt,aF as J,cB as ct,cC as it,bO as ve,ch as ot,w as Te,x as we,j as Se,v as G,bI as ie,bJ as dt,aY as De,cj as ht,cD as ut,cE as me,cF as pt,cG as mt,D as Ie,bZ as ge,A as gt,I as ft,cH as xt,cI as fe,ap as Me,bM as yt,S as P,k as Ct,m as bt,cJ as vt,ca as Tt,cK as wt,az as St,a8 as Dt,aC as It,aD as Mt,b2 as te,aE as kt,b5 as Et,cL as _t,cM as jt,bg as $t,aI as At,cN as Wt,cO as ke,cP as Bt,cQ as Ot,H as Lt,F as Nt,b as Rt,E as Ft,cR as Kt,cS as zt}from"./index-QVn94qIs.js";import{u as Pt,B as Ee,a as _e,L as Gt,T as xe,b as qt,c as Vt,d as Ht,C as Ut,e as Yt,f as Jt,E as Qt}from"./LoadoutInfoAlert-DK9X42oS.js";import{T as je}from"./TeamCard-B-Nbr4vN.js";import{u as Zt}from"./useTeamChar-DiVQSjXo.js";import{O as Xt,L as ea}from"./TeamDelModal-D4emq3Pp.js";function ta(){const{t}=E("page_character");return e(Pe,{severity:"warning",children:n(ne,{t,i18nKey:"noLoadout",children:["Looks like you haven't added any loadout/Teams with this character yet. You need to create a loadout+team with this character to"," ",e("strong",{children:"create builds"}),", ",e("strong",{children:"theorycraft"}),", or"," ",e("strong",{children:"optimize"}),"."]})})}function aa(){const t=j(),s=N();return o.useCallback(a=>{t.chars.get(a)||t.chars.getWithInitWeapon(a),s(`/characters/${a}`)},[s,t])}function na({buildId:t,characterKey:s}){const{name:r,description:a,weaponId:c,artifactIds:p}=Pt(t),d=re(s).weaponType;return e(Ee,{name:r,description:a,hideFooter:!0,children:e(u,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"stretch"},children:n(h,{container:!0,spacing:1,columns:{xs:2,sm:2,md:2,lg:3,xl:3},children:[e(h,{item:!0,xs:1,children:e(b,{sx:{height:"100%",maxHeight:"8em"},children:e(Ge,{weaponId:c,weaponTypeKey:d})})}),Object.entries(p).map(([f,x])=>e(h,{item:!0,xs:1,children:e(b,{sx:{height:"100%",maxHeight:"8em"},children:e(qe,{artifactId:x,slotKey:f})})},x||f))]})})})}function ra({buildTcId:t}){const s=_e(t),{name:r,description:a}=s;return e(Ee,{name:r,description:a,hideFooter:!0,children:e(sa,{buildTcId:t})})}function sa({buildTcId:t}){const{weapon:s,artifact:{slots:r,substats:{stats:a},sets:c}}=_e(t),p=Ve(s.key),d=Object.entries(a),f=d.slice(0,5),x=d.slice(5);return e(u,{children:n(h,{container:!0,spacing:1,columns:{xs:2,sm:2,md:2,lg:2,xl:2},children:[e(h,{item:!0,xs:1,children:n(u,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e(He,{weapon:s,weaponSheet:p}),!!Object.keys(c).length&&e(b,{sx:{flexGrow:1},children:e(u,{sx:{p:1,display:"flex",flexDirection:"column",gap:1},children:Object.entries(c).map(([i,l])=>n(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(ye,{size:2,src:Ue(i,"flower")}),e("span",{children:e(Ye,{setKey:i})}),n(ue,{children:["x",l]})]},i))})})]})}),e(h,{item:!0,xs:1,children:e(b,{sx:{flexGrow:1,height:"100%",p:1,display:"flex",flexDirection:"column",gap:1,justifyContent:"space-between"},children:Object.entries(r).map(([i,{level:l,statKey:g}])=>n(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Je,{slotKey:i}),n(ue,{children:["+",l]}),e(pe,{statKey:g})]},i))})}),[f,x].map((i,l)=>e(h,{item:!0,xs:1,children:e(b,{sx:{flexGrow:1,height:"100%"},children:e(u,{sx:{p:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",gap:1},children:i.map(([g,v])=>n(u,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"space-between"},children:[e(pe,{statKey:g}),n("span",{children:[Qe(v,ae(g)),ae(g)]})]},g))})})},l))]})})}function la({show:t,onHide:s,teamCharId:r,onDelete:a,teamIds:c,conditionalCount:p}){const{t:d}=E("loadout"),f=j(),{name:x,description:i,buildIds:l,buildTcIds:g,customMultiTargets:v,bonusStats:S}=f.teamChars.get(r),$=o.useCallback(()=>{s(),a()},[a,s]);return e(ce,{open:t,onClose:s,containerProps:{maxWidth:"md"},children:n(b,{children:[e(L,{title:e("span",{children:n(ne,{t:d,i18nKey:"loadoutDelModal.title",name:x,children:["Delete Loadout: ",e("strong",{children:{name:x}}),"?"]})}),action:e(se,{onClick:s,children:e(U,{})})}),e(A,{}),n(k,{children:[i&&e(b,{bgt:"dark",sx:{mb:2},children:e(k,{children:i})}),e(W,{children:d("loadoutDelModal.desc")}),n(Ze,{sx:{listStyleType:"disc",pl:4},children:[!!l.length&&e(O,{sx:{display:"list-item"},children:n(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[d("loadoutDelModal.builds"),l.length," ",e(K,{title:e(u,{children:l.map(C=>{var T;return n(W,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Y,{}),e("span",{children:(T=f.builds.get(C))==null?void 0:T.name})]},C)})}),children:e(z,{})})]})}),!!g.length&&e(O,{sx:{display:"list-item"},children:n(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[d("loadoutDelModal.tcBuilds"),g.length," ",e(K,{title:e(u,{children:g.map(C=>{var T;return n(W,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Y,{}),e("span",{children:(T=f.buildTcs.get(C))==null?void 0:T.name})]},C)})}),children:e(z,{})})]})}),!!v.length&&e(O,{sx:{display:"list-item"},children:n(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[d("loadoutDelModal.mTargets"),v.length," ",e(K,{title:e(u,{children:v.map((C,T)=>n(W,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Ce,{}),e("span",{children:C.name})]},T))}),children:e(z,{})})]})}),!!Object.keys(S).length&&n(O,{sx:{display:"list-item"},children:[d("loadoutDelModal.bonus"),Object.keys(S).length]}),!!p&&n(O,{sx:{display:"list-item"},children:[d("loadoutDelModal.condi"),p]}),e(O,{sx:{display:"list-item"},children:d("loadoutDelModal.optConfig")}),!!c.length&&e(O,{sx:{display:"list-item"},children:n(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[n("span",{children:[d("loadoutDelModal.affected"),c.length]}),e(K,{title:e(u,{children:c.map(C=>{var T;return n(W,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Xe,{}),e("span",{children:(T=f.teams.get(C))==null?void 0:T.name})]},C)})}),children:e(z,{})})]})})]})]}),n(et,{sx:{float:"right"},children:[e(I,{startIcon:e(U,{}),color:"secondary",onClick:s,children:d("loadoutDelModal.cancel")}),e(I,{startIcon:e(le,{}),color:"error",onClick:$,children:d("loadoutDelModal.delete")})]})]})})}function ca({show:t,onHide:s,teamCharId:r,teamIds:a}){const{t:c}=E("loadout"),[p,d,f]=be(),x=N(),i=j(),{key:l,name:g,description:v,buildIds:S,buildTcIds:$,customMultiTargets:C,bonusStats:T,optConfigId:q,conditional:R}=Zt(r),{optimizationTarget:w}=tt(q),F=()=>{s(),i.teamChars.remove(r)},Q=()=>{i.teamChars.duplicate(r)&&s()},Z=y=>{const _=i.teams.new();i.teams.set(_,X=>{X.loadoutData[0]={teamCharId:y}}),x(`/teams/${_}`)},V=o.useMemo(()=>{let y=0;return at(R,[],_=>typeof _!="object",()=>y++),y},[R]);return e(ce,{open:t,onClose:s,containerProps:{maxWidth:"lg"},children:n(b,{children:[e(L,{title:n(u,{display:"flex",gap:1,alignItems:"center",children:[e(nt,{}),e("strong",{children:g})]}),action:e(se,{onClick:s,children:e(U,{})})}),e(A,{}),n(k,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(Gt,{}),e(xe,{fullWidth:!0,label:c("loadoutEditor.label"),placeholder:c("loadoutEditor.placeholder"),value:g,onChange:y=>i.teamChars.set(r,{name:y})}),e(xe,{fullWidth:!0,label:c("loadoutEditor.desc"),value:v,onChange:y=>i.teamChars.set(r,{description:y}),multiline:!0,minRows:2}),e(u,{children:n(h,{container:!0,columns:{xs:1,md:2},spacing:2,children:[e(h,{item:!0,xs:1,children:e(I,{color:"info",onClick:()=>Q(),fullWidth:!0,startIcon:e(rt,{}),children:c("loadoutEditor.dupBtn")})}),n(h,{item:!0,xs:1,children:[e(la,{show:p,onHide:f,onDelete:F,teamCharId:r,teamIds:a,conditionalCount:V}),e(I,{fullWidth:!0,startIcon:e(le,{}),color:"error",onClick:d,children:c("loadoutEditor.delBtn")})]})]})}),e(u,{children:n(h,{container:!0,columns:{xs:1,md:2},spacing:2,children:[!!Object.keys(T).length&&e(h,{item:!0,xs:1,children:e(ia,{bonusStats:T})}),!!w&&e(h,{item:!0,xs:1,children:n(b,{bgt:"light",children:[e(L,{title:n(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(st,{}),e("span",{children:c("loadoutEditor.optTarget")})]})}),e(A,{}),e(k,{children:e(lt,{divider:e(A,{orientation:"vertical",flexItem:!0}),spacing:1,children:e(Xt,{optimizationTarget:w,customMultiTargets:C})})})]})}),!!C.length&&e(h,{item:!0,xs:1,children:e(oa,{customMultiTargets:C})}),e(h,{item:!0,xs:1,children:e(b,{bgt:"light",children:e(k,{children:n(W,{variant:"h6",children:[c("loadoutEditor.conditionals"),e("strong",{children:V})]})})})})]})})]}),e(A,{}),e(L,{title:n(u,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(Y,{}),e("span",{children:c("loadoutEditor.builds")})]})}),e(A,{}),n(k,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(qt,{}),e(u,{children:e(h,{container:!0,columns:{xs:1,md:2},spacing:2,children:S.map(y=>e(h,{item:!0,xs:1,children:e(na,{buildId:y,characterKey:l})},y))})}),e(Vt,{}),e(u,{children:e(h,{container:!0,columns:{xs:1,md:2},spacing:2,children:$.map(y=>e(h,{item:!0,xs:1,children:e(ra,{buildTcId:y})},y))})})]}),e(A,{}),e(L,{title:n(u,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(Y,{}),e("span",{children:c("loadoutEditor.teams")})]})}),e(A,{}),n(k,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(Ht,{}),n(h,{container:!0,columns:{xs:1,md:2},spacing:2,children:[a.map(y=>e(h,{item:!0,xs:1,children:e(je,{bgt:"light",teamId:y,onClick:_=>x(`/teams/${y}${_?`/${_}`:""}`)})},y)),e(h,{item:!0,xs:1,children:e(I,{fullWidth:!0,sx:{height:"100%",backgroundColor:"contentLight.main"},variant:"outlined",onClick:()=>Z(r),color:"info",startIcon:e(J,{}),children:c("loadoutEditor.addNewTeam")})})]})]})]})})}function ia({bonusStats:t}){const{t:s}=E("loadout");return n(b,{bgt:"light",children:[e(L,{title:n(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(ct,{}),e("span",{children:s("loadoutEditor.bonusStats")})]}),titleTypographyProps:{variant:"h6"}}),e(ve,{bgt:"light",sections:[{fields:Object.entries(t).map(([r,a])=>({text:it.getStr(r)??r,value:a,unit:ae(r)}))}]})]})}function oa({customMultiTargets:t}){const{t:s}=E("loadout");return n(b,{bgt:"light",children:[e(L,{title:n(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Ce,{}),e("span",{children:s("loadoutEditor.mltTargets")})]}),titleTypographyProps:{variant:"h6"}}),e(ve,{bgt:"light",sections:[{fields:t.map(({name:r,description:a})=>({text:r,value:a?e(K,{title:a,children:e(z,{})}):void 0}))}]})]})}const da={xs:1,md:2};function ha({teamCharId:t,teamIds:s}){const{t:r}=E("page_character"),a=N(),c=j(),p=i=>{const l=c.teams.new();c.teams.set(l,g=>{g.loadoutData[0]={teamCharId:i}}),a(`/teams/${l}`)},[d,f,x]=be();return n(ot,{children:[e(ca,{show:d,onHide:x,teamCharId:t,teamIds:s}),n(b,{bgt:"light",children:[e(I,{fullWidth:!0,onClick:f,sx:{p:0,display:"flex",borderBottomLeftRadius:0,borderBottomRightRadius:0},color:"neutral100",variant:"outlined",children:e(ea,{teamCharId:t,showSetting:!0})}),e(k,{sx:{p:1},children:n(h,{container:!0,columns:da,spacing:1,children:[s.map(i=>e(h,{item:!0,xs:1,children:e(je,{teamId:i,onClick:l=>a(`/teams/${i}${l?`/${l}`:""}`)})},i)),e(h,{item:!0,xs:1,children:e(I,{fullWidth:!0,sx:{height:"100%",backgroundColor:"contentNormal.main"},variant:"outlined",onClick:()=>p(t),color:"info",startIcon:e(J,{}),children:r("charContentModal.addTeam")})})]})})]},t)]})}var oe={},ua=we;Object.defineProperty(oe,"__esModule",{value:!0});var $e=oe.default=void 0,pa=ua(Te()),ma=Se,ga=(0,pa.default)((0,ma.jsx)("path",{d:"M17.5 9.5C17.5 6.46 15.04 4 12 4S6.5 6.46 6.5 9.5c0 2.7 1.94 4.93 4.5 5.4V17H9v2h2v2h2v-2h2v-2h-2v-2.1c2.56-.47 4.5-2.7 4.5-5.4zm-9 0C8.5 7.57 10.07 6 12 6s3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5z"}),"Female");$e=oe.default=ga;var de={},fa=we;Object.defineProperty(de,"__esModule",{value:!0});var Ae=de.default=void 0,xa=fa(Te()),ya=Se,Ca=(0,xa.default)((0,ya.jsx)("path",{d:"M9.5 11c1.93 0 3.5 1.57 3.5 3.5S11.43 18 9.5 18 6 16.43 6 14.5 7.57 11 9.5 11zm0-2C6.46 9 4 11.46 4 14.5S6.46 20 9.5 20s5.5-2.46 5.5-5.5c0-1.16-.36-2.23-.97-3.12L18 7.42V10h2V4h-6v2h2.58l-3.97 3.97C11.73 9.36 10.66 9 9.5 9z"}),"Male");Ae=de.default=Ca;function ba(){const{t}=E("ui"),s=j(),{character:r}=o.useContext(G),{key:a}=r,{gender:c}=ie(),p=o.useCallback(()=>s.dbMeta.set({gender:c==="F"?"M":"F"}),[c,s]);return a.startsWith("Traveler")?n(I,{onClick:p,startIcon:c==="F"?e($e,{}):e(Ae,{}),children:[e("strong",{children:t(`gender.${c}`)})," "]}):null}function va({onClose:t}){const{t:s}=E(["page_character","sillyWisher_charNames","charNames_gen"]),r=N(),a=j(),{character:c,character:{key:p}}=o.useContext(G),{gender:d}=ie(),f=dt(p,d),{silly:x}=o.useContext(De),i=o.useCallback(async()=>{const l=s(`${x?"sillyWisher_charNames":"charNames_gen"}:${ht(p,d)}`);window.confirm(s("removeCharacter",{value:l}))&&(a.chars.remove(p),r("/characters"))},[a,r,p,d,x,s]);return n(u,{display:"flex",flexDirection:"column",gap:1,children:[n(u,{display:"flex",gap:1,children:[e(ba,{}),e(I,{color:"error",onClick:()=>i(),startIcon:e(le,{}),sx:{marginLeft:"auto"},children:s("delete")}),!!t&&e(se,{onClick:t,children:e(U,{})})]}),e(u,{children:n(h,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[e(h,{item:!0,xs:8,sm:5,md:4,lg:3,children:n(b,{bgt:"light",sx:{height:"100%",display:"flex",flexDirection:"column",gap:1},children:[e(Ut,{}),e(u,{sx:{px:1},children:e(ut,{level:c.level,ascension:c.ascension,setBoth:l=>{me.includes(p)?me.forEach(g=>{a.chars.set(g,l)}):a.chars.set(p,l)}})}),e(pt,{bgt:"light"}),e(W,{sx:{textAlign:"center",pb:-1},variant:"h6",children:e(mt,{characterKey:p,gender:d})}),e(u,{sx:{px:1},children:e(Yt,{setConstellation:l=>a.chars.set(p,{constellation:l})})})]})}),n(h,{item:!0,xs:12,sm:7,md:8,lg:9,sx:{display:"flex",flexDirection:"column",gap:1},children:[e(u,{children:e(h,{container:!0,columns:3,spacing:1,children:["auto","skill","burst"].map(l=>{var g;return e(h,{item:!0,xs:1,children:e(Jt,{talentKey:l,dropDownButtonProps:{startIcon:e(ye,{src:(g=f.getTalentOfKey(l))==null?void 0:g.img,size:1.75,sideMargin:!0})},setTalent:v=>a.chars.set(p,S=>{S.talent[l]=v})},l)},l)})})}),e(Ta,{}),e(wa,{})]})]})})]})}function Ta(){const{character:{key:t,equippedArtifacts:s}}=o.useContext(G),{data:r}=o.useContext(Ie),a=j(),c=re(t).weaponType,p=r.get(ge.weapon.id).value,d=o.useMemo(()=>gt(ft,f=>r.get(ge.art[f].id).value),[r]);return e(u,{children:e(xt.Provider,{value:"equipped",children:e(Qt,{weaponTypeKey:c,weaponId:p,artifactIds:d,setWeapon:f=>{a.weapons.set(f,{location:fe(t)})},setArtifact:(f,x)=>{x?a.arts.set(x,{location:fe(t)}):a.arts.set(s[f],{location:""})}})})})}function wa(){const{t}=E("page_character"),s=N(),{character:{key:r}}=o.useContext(G),a=j(),{gender:c}=ie(),[p,d]=Me(),f=o.useMemo(()=>{const i={};return a.teamChars.entries.map(([l,g])=>{g.key===r&&(i[l]||(i[l]=[]))}),a.teams.entries.forEach(([l,g])=>{const v=g.loadoutData.find(S=>{var $;return S&&(($=a.teamChars.get(S==null?void 0:S.teamCharId))==null?void 0:$.key)===r});v&&i[v==null?void 0:v.teamCharId].push(l)}),p&&i},[p,r,a]);o.useEffect(()=>a.teams.followAny(()=>d()),[a,d]),o.useEffect(()=>a.teamChars.followAny(()=>d()),[a,d]);const x=()=>{const i=a.teams.new(),l=a.teamChars.new(r);a.teams.set(i,g=>{g.loadoutData[0]={teamCharId:l}}),s(`/teams/${i}`)};return n(u,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e(W,{variant:"h6",children:n(ne,{t,i18nKey:"charContentModal.loadoutsWith",children:["Team Loadouts with"," ",e(yt,{characterKey:r,gender:c})]})}),!Object.values(f).length&&e(ta,{}),Object.entries(f).map(([i,l])=>e(ha,{teamCharId:i,teamIds:l},i)),e(I,{fullWidth:!0,onClick:()=>x(),color:"info",startIcon:e(J,{}),variant:"outlined",sx:{backgroundColor:"contentLight.main"},children:t("charContentModal.addLoAndTeam")}),e(b,{bgt:"light"})]})}function Sa({characterKey:t,onClose:s}){return e(ce,{open:!!t,onClose:s,children:e(o.Suspense,{fallback:e(P,{variant:"rectangular",width:"100%",height:1e3}),children:t&&e(Da,{characterKey:t,onClose:s},t)})})}function Da({characterKey:t,onClose:s}){const r=Ct(t),a=bt(t),{target:c}=(a==null?void 0:a[t])??{},p=o.useMemo(()=>{if(!(!a||!c))return{data:c,teamData:a,compareData:void 0}},[c,a]),d=o.useMemo(()=>r&&{character:r},[r]),[f,x]=o.useState(),[i,l]=o.useState(),g=o.useMemo(()=>({chartData:f,setChartData:x,graphBuilds:i,setGraphBuilds:l}),[f,i]);return o.useEffect(()=>{x(void 0),l(void 0)},[t]),e(b,{children:e(k,{sx:{display:"flex",flexDirection:"column",gap:1},children:e(o.Suspense,{fallback:e(P,{variant:"rectangular",width:"100%",height:1e3}),children:p&&d&&g?e(G.Provider,{value:d,children:e(Ie.Provider,{value:p,children:e(vt.Provider,{value:g,children:e(va,{onClose:s})})})}):e(P,{variant:"rectangular",width:"100%",height:1e3})})})})}const Ia={xs:1,sm:2,md:3,lg:4,xl:4},Ma={xs:5,sm:8,md:9,lg:12,xl:12},ka=Object.keys(ke);function Wa(){const t=j(),s=N(),{params:{characterKey:r}}=Tt({path:"/characters/:characterKey",end:!1})??{params:{}},a=o.useMemo(()=>r?wt(r)?(t.chars.get(r)||t.chars.getWithInitWeapon(r),r):(s("/characters"),null):null,[r,s,t]),{t:c}=E(["page_character","sillyWisher_charNames","charNames_gen"]),{silly:p}=o.useContext(De),[d,f]=o.useState(()=>t.displayCharacter.get());o.useEffect(()=>t.displayCharacter.follow((m,D)=>f(D)),[t,f]);const[x,i]=o.useState(""),l=o.useDeferredValue(x),g=St(),[v,S]=o.useState(!1),[$,C]=Me();o.useEffect(()=>(Dt.send({hitType:"pageview",page:"/characters"}),t.chars.followAny((m,D)=>(D==="new"||D==="remove")&&C())),[C,t]),o.useEffect(()=>t.charMeta.followAny(m=>C()),[C,t]);const T=aa(),q=o.useDeferredValue(d),R=o.useDeferredValue($),{charKeys:w,totalCharNum:F}=o.useMemo(()=>{const D=t.chars.keys.length,{element:B,weaponType:M,rarity:H,sortType:Fe,ascending:Ke}=q,ze=t.chars.keys.filter(It({element:B,weaponType:M,rarity:H,name:l},Bt(t,p))).sort(Mt(ke[Fe]??[],Ke,Ot(t,p),["new","favorite"]));return R&&{charKeys:ze,totalCharNum:D}},[t,q,l,p,R]),{weaponType:Q,element:Z,rarity:V,sortType:y,ascending:_}=d,X=o.useMemo(()=>te(Nt,m=>Object.entries(t.chars.data).forEach(([D,B])=>{const M=t.weapons.get(B.equippedWeapon);if(!M)return;const H=Lt(M.key).weaponType;m[H].total++,w.includes(D)&&m[H].current++})),[t,w]),We=o.useMemo(()=>te(Ft,m=>Object.entries(t.chars.data).forEach(([D,B])=>{const M=Rt(B.key);m[M].total++,w.includes(D)&&m[M].current++})),[t,w]),Be=o.useMemo(()=>te(Kt,m=>Object.entries(t.chars.data).forEach(([D,B])=>{const M=re(B.key).rarity;m[M].total++,w.includes(D)&&m[M].current++})),[t,w]),{numShow:he,setTriggerElement:Oe}=kt(Ma[g],w.length),ee=o.useMemo(()=>w.slice(0,he),[w,he]),Le=w.length!==F?`${w.length}/${F}`:`${F}`,Ne={numShowing:ee.length,total:Le,t:c,namespace:"page_character"},Re={sortKeys:[...ka],value:y,onChange:m=>t.displayCharacter.set({sortType:m}),ascending:_,onChangeAsc:m=>t.displayCharacter.set({ascending:m})};return n(u,{display:"flex",flexDirection:"column",gap:1,children:[a&&e(Sa,{characterKey:a,onClose:()=>s("/characters")}),e(o.Suspense,{fallback:!1,children:e(zt,{newFirst:!0,show:v,onHide:()=>S(!1),onSelect:T})}),e(b,{children:n(k,{sx:{display:"flex",flexDirection:"column",gap:1},children:[n(h,{container:!0,spacing:1,children:[e(h,{item:!0,children:e(Et,{sx:{height:"100%"},onChange:m=>t.displayCharacter.set({weaponType:m}),value:Q,totals:X,size:"small"})}),e(h,{item:!0,children:e(_t,{sx:{height:"100%"},onChange:m=>t.displayCharacter.set({element:m}),value:Z,totals:We,size:"small"})}),e(h,{item:!0,children:e(jt,{sx:{height:"100%"},onChange:m=>t.displayCharacter.set({rarity:m}),value:V,totals:Be,size:"small"})}),e(h,{item:!0,flexGrow:1}),e(h,{item:!0,children:e($t,{autoFocus:!0,value:x,onChange:m=>i(m.target.value),label:c("characterName"),size:"small",sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]}),e(u,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:e(At,{showingTextProps:Ne,sortByButtonProps:Re})})]})}),e(I,{fullWidth:!0,onClick:()=>S(!0),color:"info",startIcon:e(J,{}),children:c("addNew")}),e(o.Suspense,{fallback:e(P,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:e(h,{container:!0,spacing:1,columns:Ia,children:ee.map(m=>e(h,{item:!0,xs:1,children:e(Wt,{characterKey:m,onClick:()=>s(`${m}`),hideStats:!0})},m))})}),w.length!==ee.length&&e(P,{ref:m=>{m&&Oe(m)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100})]})}export{Wa as default};
